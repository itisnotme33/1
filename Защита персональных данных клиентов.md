
<h1>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#–ó–∞–≥—Ä—É–∑–∫–∞-–¥–∞–Ω–Ω—ã—Ö" data-toc-modified-id="–ó–∞–≥—Ä—É–∑–∫–∞-–¥–∞–Ω–Ω—ã—Ö-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></span></li><li><span><a href="#–£–º–Ω–æ–∂–µ–Ω–∏–µ-–º–∞—Ç—Ä–∏—Ü" data-toc-modified-id="–£–º–Ω–æ–∂–µ–Ω–∏–µ-–º–∞—Ç—Ä–∏—Ü-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>–£–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü</a></span></li><li><span><a href="#–ê–ª–≥–æ—Ä–∏—Ç–º-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è" data-toc-modified-id="–ê–ª–≥–æ—Ä–∏—Ç–º-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è</a></span></li><li><span><a href="#–ü—Ä–æ–≤–µ—Ä–∫–∞-–∞–ª–≥–æ—Ä–∏—Ç–º–∞" data-toc-modified-id="–ü—Ä–æ–≤–µ—Ä–∫–∞-–∞–ª–≥–æ—Ä–∏—Ç–º–∞-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞</a></span></li><li><span><a href="#–ß–µ–∫-–ª–∏—Å—Ç-–ø—Ä–æ–≤–µ—Ä–∫–∏" data-toc-modified-id="–ß–µ–∫-–ª–∏—Å—Ç-–ø—Ä–æ–≤–µ—Ä–∫–∏-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>–ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏</a></span></li></ul></div>

# –ó–∞—â–∏—Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

–í–∞–º –Ω—É–∂–Ω–æ –∑–∞—â–∏—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ ¬´–•–æ—Ç—å –ø–æ—Ç–æ–ø¬ª. –†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Ç–∞–∫–æ–π –º–µ—Ç–æ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –ø–æ –Ω–∏–º –±—ã–ª–æ —Å–ª–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –û–±–æ—Å–Ω—É–π—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –µ–≥–æ —Ä–∞–±–æ—Ç—ã.

–ù—É–∂–Ω–æ –∑–∞—â–∏—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ–±—ã –ø—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–µ —É—Ö—É–¥—à–∏–ª–æ—Å—å. –ü–æ–¥–±–∏—Ä–∞—Ç—å –Ω–∞–∏–ª—É—á—à—É—é –º–æ–¥–µ–ª—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.



## –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö


```python
import pandas as pd
import numpy as np

from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split

from sklearn.metrics import r2_score
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
```


```python
data = pd.read_csv('/datasets/insurance.csv')
```


```python
data.info()
data.head()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 5000 entries, 0 to 4999
    Data columns (total 5 columns):
     #   Column             Non-Null Count  Dtype  
    ---  ------             --------------  -----  
     0   –ü–æ–ª                5000 non-null   int64  
     1   –í–æ–∑—Ä–∞—Å—Ç            5000 non-null   float64
     2   –ó–∞—Ä–ø–ª–∞—Ç–∞           5000 non-null   float64
     3   –ß–ª–µ–Ω—ã —Å–µ–º—å–∏        5000 non-null   int64  
     4   –°—Ç—Ä–∞—Ö–æ–≤—ã–µ –≤—ã–ø–ª–∞—Ç—ã  5000 non-null   int64  
    dtypes: float64(2), int64(3)
    memory usage: 195.4 KB






<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>–ü–æ–ª</th>
      <th>–í–æ–∑—Ä–∞—Å—Ç</th>
      <th>–ó–∞—Ä–ø–ª–∞—Ç–∞</th>
      <th>–ß–ª–µ–Ω—ã —Å–µ–º—å–∏</th>
      <th>–°—Ç—Ä–∞—Ö–æ–≤—ã–µ –≤—ã–ø–ª–∞—Ç—ã</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>41.0</td>
      <td>49600.0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>46.0</td>
      <td>38000.0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>29.0</td>
      <td>21000.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>21.0</td>
      <td>41700.0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>28.0</td>
      <td>26100.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.duplicated().sum()
```




    153



–°—á–∏—Ç–∞—é, –¥—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª—è—Ç—å –Ω–µ —Å—Ç–æ–∏—Ç. –ü–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤–ø–æ–ª–Ω–µ —Ä–µ–∞–ª—å–Ω–æ.


```python
data.isna().sum()
```




    –ü–æ–ª                  0
    –í–æ–∑—Ä–∞—Å—Ç              0
    –ó–∞—Ä–ø–ª–∞—Ç–∞             0
    –ß–ª–µ–Ω—ã —Å–µ–º—å–∏          0
    –°—Ç—Ä–∞—Ö–æ–≤—ã–µ –≤—ã–ø–ª–∞—Ç—ã    0
    dtype: int64




## –£–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü



–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:

- $X$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–Ω—É–ª–µ–≤–æ–π —Å—Ç–æ–ª–±–µ—Ü —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –µ–¥–∏–Ω–∏—Ü)

- $y$ ‚Äî –≤–µ–∫—Ç–æ—Ä —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞

- $P$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é —É–º–Ω–æ–∂–∞—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏

- $w$ ‚Äî –≤–µ–∫—Ç–æ—Ä –≤–µ—Å–æ–≤ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (–Ω—É–ª–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç —Ä–∞–≤–µ–Ω —Å–¥–≤–∏–≥—É)

–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:

$$
a = Xw
$$

–ó–∞–¥–∞—á–∞ –æ–±—É—á–µ–Ω–∏—è:

$$
w = \arg\min_w MSE(Xw, y)
$$

–§–æ—Ä–º—É–ª–∞ –æ–±—É—á–µ–Ω–∏—è:

$$
w = (X^T X)^{-1} X^T y
$$

–ü—Ä–∏–∑–Ω–∞–∫–∏ —É–º–Ω–æ–∂–∞—é—Ç –Ω–∞ –æ–±—Ä–∞—Ç–∏–º—É—é –º–∞—Ç—Ä–∏—Ü—É. –ò–∑–º–µ–Ω–∏—Ç—Å—è –ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏?

**–û—Ç–≤–µ—Ç:** –ù–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –î–æ–∫–∞–∂–µ–º, —á—Ç–æ $ a' = a  $

$$X' = XP$$

$$w' = ((XP)^T (XP))^{-1} (XP)^T y = (P^{T}X^{T}XP)^{-1}P^{T}X^{T}y$$

–î–∞–ª–µ–µ –ø—Ä–∏–º–µ–Ω–∏–º –æ–±—Ä–∞—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü

$$w' = (X^T XP)^{-1} (P^T)^{-1}P^TX^{T}y = (X^{T}XP)^{-1}X^{T}y$$

–ï—â–µ —Ä–∞–∑ –ø—Ä–∏–º–µ–Ω–∏–º –æ–±—Ä–∞—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü

$$w' = P^{-1}(X^{T}X)^{-1}X^{T}y$$

$$X'w' = XPw' = XPP^{-1} (X^TX)^{-1}X^{T} y = X(X^{T}X)^{-1}X^{T}y = Xw$$


<div class="alert alert-info"> –ú—ã –≤—ã—à–µ –¥–æ–∫–∞–∑–∞–ª–∏ —Å–ª–µ–¥—É—é—â–µ–µ: </div>

$ a' = a = Xw =XPw' $

<div class="alert alert-info"> –ó–Ω–∞—á–∏—Ç, —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ: </div>

$$ w = Pw'$$



## –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

**–ê–ª–≥–æ—Ä–∏—Ç–º**

 –£–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—É—é —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –æ–±—Ä–∞—Ç–∏–º—É—é –º–∞—Ç—Ä–∏—Ü—É




<div class="alert alert-warning">
<font size="5"><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font>

–°–æ–≤–µ—Ç ü§î:



–î–º–∏—Ç—Ä–∏–π, —Ç—É—Ç –º—ã –ø–æ –ø—É–Ω–∫—Ç–∞–º, —Å–ª–æ–≤–∞–º–∏ —Ä–∞—Å–ø–∏—Å—ã–≤–∞–µ–º —Å–ª–æ–≤–∞–º–∏ –ø–æ—Ä—è–¥–æ–∫ –Ω–∞—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π, —Å —É—á–µ—Ç–æ–º: —á—Ç–æ –∑–∞ –º–∞—Ç—Ä–∏—Ü–∞, –∫–∞–∫–∏–º —Éc–ª–æ–≤–∏—è–º –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å, –∫–∞–∫–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞, —á—Ç–æ –Ω–∞ —á—Ç–æ –ø–µ—Ä–µ–º–Ω–æ–∂–∞–µ–º—ã—Ö, —á—Ç–æ –¥–µ–ª–∞–µ–º –µ—Å–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ú–∞—Ç—Ä–∏—Ü–∞ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞—è –∏—Ç–¥ –∏—Ç–ø. –≠—Ç–æ –∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º. –¢–∞–º —Ü–µ–ª–∞—è —Ç–µ–æ—Ä–∏—è, –º–æ–∂–Ω–æ —Å—Ö–µ–º—ã [—Ä–∏—Å–æ–≤–∞—Ç—å](https://yandex.ru/images/search?pos=0&img_url=http%3A%2F%2Fimages.myshared.ru%2F6%2F674342%2Fslide_13.jpg&text=%D0%9F%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D0%B0%20%D0%BD%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D1%8F%20%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%D0%B0%20%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%D0%B0%20%D0%BD%D0%B0%20%D0%BF%D0%B8%D1%82%D0%BE%D0%BD%D0%B5&lr=43&rpt=simage&source=serp&rlt_url=https%3A%2F%2Ffs.znanio.ru%2Fd5af0e%2F50%2F9c%2Ffc07a3f83eed5c7e727ae0bb808ea8b774.jpg&ogl_url=http%3A%2F%2Fimages.myshared.ru%2F6%2F674342%2Fslide_13.jpg)

–ê –∑–∞—Ç–µ–º, –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –ø—Ä–æ–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏ –ø–∏—à–µ–º –∫–æ–¥ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ä–∞–∑–¥–µ–ª–µ

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**

–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—é –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –º–∞—Ç—Ä–∏—Ü–µ, —á—Ç–æ —Å–¥–µ–ª–∞–µ—Ç –µ–µ –Ω–µ—Ä–∞–∑–±–æ—Ä—á–∏–≤–æ–π –∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–π –¥–ª—è —á—Ç–µ–Ω–∏—è –±–µ–∑ –∑–Ω–∞–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–Ω—É—Ç –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–º–∏ –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏ –±—É–¥—É—Ç –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –∫—Ä–∞–∂–∏, –≤–∑–ª–æ–º–∞ –∏ –¥—Ä—É–≥–∏—Ö –≤–∏–¥–æ–≤ –∞—Ç–∞–∫.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞

–ó–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º, –ø—Ä–∏–º–µ–Ω–∏–≤ –º–∞—Ç—Ä–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–∞—á–µ—Å—Ç–≤–æ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏–∑ sklearn –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –¥–æ –∏ –ø–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–µ—Ç—Ä–∏–∫—É R2.

–î–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è


```python
features = data.drop('–°—Ç—Ä–∞—Ö–æ–≤—ã–µ –≤—ã–ø–ª–∞—Ç—ã',axis=1)
target = data['–°—Ç—Ä–∞—Ö–æ–≤—ã–µ –≤—ã–ø–ª–∞—Ç—ã']
```


```python
features_train, features_test, target_train, target_test = train_test_split(features, target, test_size=0.25, random_state=12345)
```


```python
model = LinearRegression()
model.fit(features_train, target_train)
R2 = r2_score(target_test, model.predict(features_test))
print("R2 =", R2)
```

    R2 = 0.43522757127026546



```python
# –û—Ç–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
regressor = LinearRegression()
scaller = StandardScaler()
pipeline = Pipeline([("standard_scaller", scaller),("linear_regression", regressor)])
pipeline.fit(features_train, target_train)
R2_scale = r2_score(target_test, pipeline.predict(features_test))
print("R2 =", R2_scale)
```

    R2 = 0.4352275712702668


<div class="alert alert-warning">
<font size="5"><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font>

–°–æ–≤–µ—Ç ü§î:



–ú–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å pipeline, —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö - –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É. –ö–∞–∫–æ–≥–æ —Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–º—ã—Å–ª–∞ —ç—Ç–æ –∏–º–µ—Ç—å –Ω–µ –±—É–¥–µ—Ç, –Ω–∞–ø–æ–º–Ω—é —á—Ç–æ pipeline –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–ø–ª—é—Å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∫—Ä–∞—Ç–∫–æ—Å—Ç—å ), –∑–∞—Ç–æ –º–æ–∂–Ω–æ –ø–æ—É–ø—Ä–∞–∂–Ω—è—Ç—å—Å—è.

 
–ú–æ–∂–µ—à—å –≤–∑—è—Ç—å –∑–∞ –æ—Å–Ω–æ–≤—É [–°—Å—ã–ª–∫–∞ 1](https://dzen.ru/media/id/5ee6f73b7cadb75a66e4c7e3/sozdanie-polzovatelskih-preobrazovatelei-dannyh-62b2a9a80e49941961ffc7a2),
[–°—Å—ã–ª–∫–∞ 2](https://towardsdatascience.com/pipelines-custom-transformers-in-scikit-learn-the-step-by-step-guide-with-python-code-4a7d9b068156)

–ù–∞ –≤—ã—Ö–æ–¥–µ –º—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ

    pipe_cripto = Pipeline([
            ('transformer', MatrixTransformer(X.columns)),
            ('model', LinearRegression()),
        ])


    pipe_cripto.fit(X_train)

    pipe_cripto.predict(X_test)








–ü–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è


```python
random = np.random.normal(size=(4,4))
np.linalg.inv(random) 
features_inv = features @ random
features_inv.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-28460.280420</td>
      <td>-25217.422735</td>
      <td>-8929.300872</td>
      <td>38623.421766</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-21817.167460</td>
      <td>-19323.703824</td>
      <td>-6837.296095</td>
      <td>29606.337575</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-12060.125335</td>
      <td>-10679.758931</td>
      <td>-3777.423861</td>
      <td>16365.131054</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-23915.650112</td>
      <td>-21197.377428</td>
      <td>-7511.545701</td>
      <td>32458.110550</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-14981.587221</td>
      <td>-13271.365335</td>
      <td>-4696.522135</td>
      <td>20330.462054</td>
    </tr>
  </tbody>
</table>
</div>






<div class="alert alert-warning">
<font size="5"><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font>

–°–æ–≤–µ—Ç ü§î:





- –µ—Å–ª–∏ –º–∞—Ç—Ä–∏—Ü–∞ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞—è –≤—ã—Å–∫–æ—á–∏—Ç –æ—à–∏–±–∫–∞ –Ω–∞ np.linalg.inv, –∫–æ–¥ –Ω–µ –∏—Å–ø–æ–ª–Ω–∏—Ç—Å—è –¥–æ –∫–æ–Ω—Ü–∞
   
–ú–æ–∂–Ω–æ –∑–¥–µ—Å—å –±—ã–ª–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ—Ö–∏—Ç—Ä–µ–π - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –º–∞—Ç—Ä–∏—Ü—É –ø–æ–∫–∞ –Ω–µ –ø–æ–ª—É—á–∏–º –æ–±—Ä–∞—Ç–∏–º—É—é –∏ –Ω–∞—à –∫–æ–¥  –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Ä–∞–±–æ—Ç–∞–µ—Ç. –î–æ–±–∏—Ç—å—Å—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –Ω–∞–ø—Ä–∏–º–µ—Ä —Ç–∞–∫:


    
    def get_rand_matrix():
        det = 0
        while det == 0:
            matrix = np.random.normal(size=(data.shape[1], data.shape[1]))
            det = np.linalg.det(matrix)
        return matrix

C –ø–æ–º–æ—â—å—é —Ä–µ–∫—É—Ä—Å–∏–∏

    def func(dim):
        transform_matrix = np.random.rand(dim, dim)
        try: 
            inv = np.linalg.inv(transform_matrix)
            return transform_matrix, inv
        except:
            func(dim)  
    

- —á—Ç–æ –Ω–∞—Å—á–µ—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞? –°–µ–π—á–∞—Å —Ç—ã —Ü–∏—Ñ—Ä–æ–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—à—å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Å–ª—É—á–∞–π–Ω–æ–π –º–∞—Ç—Ä–∏—á–∫–∏, –ø–æ—á–µ–º—É –±—ã –Ω–µ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –º–∞—Ç—Ä–∏—Ü—ã –æ–±—å–µ–∫—Ç-–ø—Ä–∏–∑–Ω–∞–∫?      
    

    


```python
features_train, features_test, target_train, target_test = train_test_split(features, target, test_size=0.25, random_state=12345)
```


```python
model = LinearRegression()
model.fit(features_train, target_train)
R2_new = r2_score(target_test, model.predict(features_test))
print("R2 =", R2_new)
```

    R2 = 0.43522757127026546



```python
regressor = LinearRegression()
scaller = StandardScaler()
pipeline = Pipeline([("standard_scaller", scaller),("linear_regression", regressor)])
pipeline.fit(features_train, target_train)
R2_new_scale = r2_score(target_test, pipeline.predict(features_test))
print("R2 =", R2_new_scale)
```

    R2 = 0.4352275712702668


–í—ã–≤–æ–¥: –∑–Ω–∞—á–µ–Ω–∏–µ R2  –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –¥–æ –∏ –ø–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è



<div class="alert alert-success">
<font size="5"><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font>

–£—Å–ø–µ—Ö üëç:
    
–í—Å–µ —Å–æ—à–ª–æ—Å—å. –û—Ç–¥–µ–ª—å–Ω—ã–π –ø–ª—é—Å –∑–∞: 
    
    


- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ train_test_split - –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ–º–Ω–∏–º –æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞—Ö ML –ø—Ä–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–∏

  

–ò—Ç–∞–∫, –º—ã —Å–º–æ–≥–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –±—ã–ª–æ —Å–ª–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –ü—Ä–∏ —ç—Ç–æ–º –∫–∞—á–µ—Å—Ç–≤–æ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å–∏–∏ –æ—Å—Ç–∞–ª–æ—Å—å –ø—Ä–µ–∂–Ω–∏–º, –æ —á–µ–º –Ω–∞–º –≥–æ–≤–æ—Ä—è—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è R2 –¥–æ –∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π.


<div class="alert alert-info">
<font size="5"><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font>


–î–º–∏—Ç—Ä–∏–π, —É —Ç–µ–±—è —Å—Ç–∞—Ä–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –≤—Å–µ —á–µ—Ç–∫–æ, –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ. –û—Ç–º–µ—á–∞—é —É—Ä–æ–≤–µ–Ω—å —Ç–≤–æ–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—Å–∫–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏. 


–ò –≤—ã–≤–æ–¥—ã –Ω–∞ –º–µ—Å—Ç–µ. 

    
    

–Ø –æ—Å—Ç–∞–≤–∏–ª –Ω–µ–±–æ–ª—å—à–∏–µ —Å–æ–≤–µ—Ç—ã –∏ –≤–æ–ø—Ä–æ—Å–∏–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å –≤—Ä–µ–º—è –∏ –∂–µ–ª–∞–Ω–∏–µ –º–æ–∂–µ—à—å –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è/–æ—Ç–≤–µ—Ç–∏—Ç—å)
    


–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:



    

- –≤—ã–≤–æ–¥–∏–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º–µ–∂–¥—É  ùë§  –∏  ùë§ùëù 




–ñ–¥—É –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π, –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞. –ï—Å–ª–∏ –∫–∞–∫–∏–µ —Ç–æ –≤–æ–ø—Ä–æ—Å—ã, —Ç–æ —Å—Ä–∞–∑—É —Å–ø—Ä–∞—à–∏–≤–∞–π ) 








<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b>



–ù–∞ –º–æ–π –≤–∑–≥–ª—è–¥ –ø—Ä–æ–µ–∫—Ç –æ—á–µ–Ω—å –Ω–µ–æ–±—ã—á–Ω—ã–π, –≤—ã–¥–µ–ª—è—é—â–∏–π—Å—è –∏–∑ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª–∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –ª–µ–∂–∞—â–µ–π –≤ –æ—Å–Ω–æ–≤–µ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è  (–ø–æ–º–∏–º–æ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö, –º–∞—Ç–∞–Ω–∞–ª–∏–∑–∞ –∏ —Ç–µ–æ—Ä–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å –º–∞—Ç—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π). –ï—Å–ª–∏ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º —Ç—ã —É–≥–ª—É–±–∏—à—å—Å—è –≤ –∏–∑—É—á–µ–Ω–∏–∏ –Ω–µ–π—Ä–æ—Å—Ç–µ—Ç–µ–π, —Ç–æ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä—ã –±—É–¥–µ—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã–º, –ø–æ—Ç–æ–º—É —á—Ç–æ, –ø–æ —Å—É—Ç–∏, –≤—Å–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ - —ç—Ç–æ –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü –∏ –õ–∏–Ω–µ–π–Ω–∞—è –∞–ª–≥–µ–±—Ä–∞ –¥–∞—ë—Ç –æ—á–µ–Ω—å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –∑–∞–ø–∏—Å–∏ —Ç–æ–≥–æ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –Ω–µ–π—Ä–æ—Å–µ—Ç—è—Ö. 

–ö—Ä–æ–º–µ —Ç–æ–≥–æ —è–∑—ã–∫–æ–º –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä–∞ –º–æ–∂–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ pca (—á–µ—Ä–µ–∑ —Å–∏–Ω–≥—É–ª—è—Ä–Ω–æ–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ)

–ú–Ω–µ –Ω–µ –æ—á–µ–Ω—å –Ω—Ä–∞–≤–∏—Ç—Å—è —ç—Ç–∏ —Å—Å—ã–ª–∫–∏, –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –ø–æ–ª—É—á—à–µ, –Ω–æ —Ç–∞–º –≤–ø–æ–ª–Ω–µ –Ω–∞–≥–ª—è–¥–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–≤—è–∑—å –º–µ–∂–¥—É –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä—ã –∏ –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–º –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω–æ–º
    
https://www.youtube.com/watch?v=kmdqBlls_HQ    
https://www.youtube.com/watch?v=AOZZeTQl4Xc


–≠—Ç–æ –¥–∞–∂–µ –≤–∞–∂–Ω–æ –∫–∞–∫ "–ø–æ–Ω—è—Ç–∏–π–Ω—ã–π —è–∑—ã–∫", –≤–æ—Ç –∑–¥–µ—Å—å –æ –º–æ–¥–µ–ª–∏ word2vec (—ç—Ç–æ NLP) —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å—Å—è "—è–∑—ã–∫–æ–º –ª–∏–Ω–µ–π–Ω–æ–π –∞–ª–≥–µ–±—Ä—ã" —Å [22 –º–∏–Ω—É—Ç—ã](https://www.youtube.com/watch?v=MBQdMQUZMQM&t=3340s) 
    

–í–æ–∑–º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–æ:
    
    

    
- –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–æ–±—â–µ –ø—Ä–æ –ª–∏–Ω–µ–π–Ω—É—é –∞–ª–≥–µ–±—Ä—É –∏ –º–∞—Ç—Ä–∏—Ü—ã, —Ç–æ –º–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è  –≤–æ—Ç —ç—Ç–æ [–≤–∏–¥–µ–æ](https://www.youtube.com/watch?v=RNTRYicPvWQ&list=PLVjLpKXnAGLXPaS7FRBjd5yZeXwJxZil2), —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ —Å—É—â–µ—Å—Ç–≤—É –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ.  


- –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º: [—Ç—É—Ç](https://www.cs.cmu.edu/~rjhall/JOS_revised_May_31a.pdf)





<div class="alert alert-info">
<font size="5"><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞V2</b></font>

–°–ø–∞—Å–∏–±–æ –∑–∞ —Ä–∞–±–æ—Ç—É!    

    

–ö—Ä–∞—Å–Ω–æ–≥–æ –Ω–µ—Ç, –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–µ—Ç, –∑–Ω–∞—á–∏—Ç –≤—Å–µ, –ø–æ—Ä–∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å) –ù–∞–¥–µ—é—Å—å –º–æ–∏ —Å–æ–≤–µ—Ç—ã –∏ –≤–æ–ø—Ä–æ—Å–∏–∫–∏ –±—ã–ª–∏ –ø–æ–ª–µ–∑–Ω—ã –∏ –≤ –∫–æ–ø–∏–ª–æ—á–∫—É –∑–Ω–∞–Ω–∏–π —É–ø–∞–ª–æ —á—Ç–æ —Ç–æ –Ω–æ–≤–æ–µ, –∞ –ø—Ä–æ–µ–∫—Ç —Å—Ç–∞–ª –ª—É—á—à–µ, –∏ —Å–∏–º–ø–∞—Ç–∏—á–Ω–µ–π.

  
–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –î–º–∏—Ç—Ä–∏–π. –ñ–µ–ª–∞—é —É—Å–ø–µ—Ö–æ–≤ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–π —É—á–µ–±–µ!



## –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

–ü–æ—Å—Ç–∞–≤—å—Ç–µ 'x' –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–∞—Ö. –î–∞–ª–µ–µ –Ω–∞–∂–º–∏—Ç–µ Shift+Enter.

- [x]  Jupyter Notebook –æ—Ç–∫—Ä—ã—Ç
- [x]  –í–µ—Å—å –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [x]  –Ø—á–µ–π–∫–∏ —Å –∫–æ–¥–æ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –ø–æ—Ä—è–¥–∫–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- [x]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 1: –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
- [x]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 2: –ø–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –æ–± —É–º–Ω–æ–∂–µ–Ω–∏–∏ –º–∞—Ç—Ä–∏—Ü
    - [x]  –£–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞
    - [x]  –í–∞—Ä–∏–∞–Ω—Ç –æ–±–æ—Å–Ω–æ–≤–∞–Ω
- [x]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 3: –ø—Ä–µ–¥–ª–æ–∂–µ–Ω –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
    - [x]  –ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø–∏—Å–∞–Ω
    - [x]  –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±–æ—Å–Ω–æ–≤–∞–Ω
- [x]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 4: –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–µ–Ω
    - [x]  –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
    - [x]  –ü—Ä–æ–≤–µ–¥–µ–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π –¥–æ –∏ –ø–æ—Å–ª–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è


```python

```
