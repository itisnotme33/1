


```python

```

<h1>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö" data-toc-modified-id="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></span></li><li><span><a href="#–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ-–∑–∞–¥–∞—á–∏" data-toc-modified-id="–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ-–∑–∞–¥–∞—á–∏-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</a></span></li><li><span><a href="#–ë–æ—Ä—å–±–∞-—Å-–¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º" data-toc-modified-id="–ë–æ—Ä—å–±–∞-—Å-–¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>–ë–æ—Ä—å–±–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º</a></span></li><li><span><a href="#–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–º–æ–¥–µ–ª–∏" data-toc-modified-id="–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–º–æ–¥–µ–ª–∏-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</a></span></li><li><span><a href="#–ß–µ–∫-–ª–∏—Å—Ç-–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏-–ø—Ä–æ–µ–∫—Ç–∞" data-toc-modified-id="–ß–µ–∫-–ª–∏—Å—Ç-–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏-–ø—Ä–æ–µ–∫—Ç–∞-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>–ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞</a></span></li></ul></div>

# –û—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤

–ò–∑ ¬´–ë–µ—Ç–∞-–ë–∞–Ω–∫–∞¬ª —Å—Ç–∞–ª–∏ —É—Ö–æ–¥–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—ã. –ö–∞–∂–¥—ã–π –º–µ—Å—è—Ü. –ù–µ–º–Ω–æ–≥–æ, –Ω–æ –∑–∞–º–µ—Ç–Ω–æ. –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥–∏ –ø–æ—Å—á–∏—Ç–∞–ª–∏: —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–µ–∫—É—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–µ—à–µ–≤–ª–µ, —á–µ–º –ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å –Ω–æ–≤—ã—Ö.

–ù—É–∂–Ω–æ —Å–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å, —É–π–¥—ë—Ç –∫–ª–∏–µ–Ω—Ç –∏–∑ –±–∞–Ω–∫–∞ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –∏–ª–∏ –Ω–µ—Ç. –í–∞–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Ä–∞—Å—Ç–æ—Ä–∂–µ–Ω–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —Å –±–∞–Ω–∫–æ–º. 

–ü–æ—Å—Ç—Ä–æ–π—Ç–µ –º–æ–¥–µ–ª—å —Å –ø—Ä–µ–¥–µ–ª—å–Ω–æ –±–æ–ª—å—à–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º *F1*-–º–µ—Ä—ã. –ß—Ç–æ–±—ã —Å–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ, –Ω—É–∂–Ω–æ –¥–æ–≤–µ—Å—Ç–∏ –º–µ—Ç—Ä–∏–∫—É –¥–æ 0.59. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ *F1*-–º–µ—Ä—É –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏–∑–º–µ—Ä—è–π—Ç–µ *AUC-ROC*, —Å—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ –µ—ë –∑–Ω–∞—á–µ–Ω–∏–µ —Å *F1*-–º–µ—Ä–æ–π.

–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: [https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling](https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling)

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö


```python
import pandas as pd
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split
from sklearn.metrics import f1_score
from sklearn.preprocessing import StandardScaler
from tqdm import tqdm
import matplotlib.pyplot as plt
from sklearn.metrics import roc_curve
from sklearn.metrics import roc_auc_score
from sklearn.utils import shuffle
```


```python
data = pd.read_csv('/datasets/Churn.csv')
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 10000 entries, 0 to 9999
    Data columns (total 14 columns):
     #   Column           Non-Null Count  Dtype  
    ---  ------           --------------  -----  
     0   RowNumber        10000 non-null  int64  
     1   CustomerId       10000 non-null  int64  
     2   Surname          10000 non-null  object 
     3   CreditScore      10000 non-null  int64  
     4   Geography        10000 non-null  object 
     5   Gender           10000 non-null  object 
     6   Age              10000 non-null  int64  
     7   Tenure           9091 non-null   float64
     8   Balance          10000 non-null  float64
     9   NumOfProducts    10000 non-null  int64  
     10  HasCrCard        10000 non-null  int64  
     11  IsActiveMember   10000 non-null  int64  
     12  EstimatedSalary  10000 non-null  float64
     13  Exited           10000 non-null  int64  
    dtypes: float64(3), int64(8), object(3)
    memory usage: 1.1+ MB





```python
data.head()
```





<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RowNumber</th>
      <th>CustomerId</th>
      <th>Surname</th>
      <th>CreditScore</th>
      <th>Geography</th>
      <th>Gender</th>
      <th>Age</th>
      <th>Tenure</th>
      <th>Balance</th>
      <th>NumOfProducts</th>
      <th>HasCrCard</th>
      <th>IsActiveMember</th>
      <th>EstimatedSalary</th>
      <th>Exited</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>15634602</td>
      <td>Hargrave</td>
      <td>619</td>
      <td>France</td>
      <td>Female</td>
      <td>42</td>
      <td>2.0</td>
      <td>0.00</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>101348.88</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>15647311</td>
      <td>Hill</td>
      <td>608</td>
      <td>Spain</td>
      <td>Female</td>
      <td>41</td>
      <td>1.0</td>
      <td>83807.86</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>112542.58</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>15619304</td>
      <td>Onio</td>
      <td>502</td>
      <td>France</td>
      <td>Female</td>
      <td>42</td>
      <td>8.0</td>
      <td>159660.80</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>113931.57</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>15701354</td>
      <td>Boni</td>
      <td>699</td>
      <td>France</td>
      <td>Female</td>
      <td>39</td>
      <td>1.0</td>
      <td>0.00</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>93826.63</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>15737888</td>
      <td>Mitchell</td>
      <td>850</td>
      <td>Spain</td>
      <td>Female</td>
      <td>43</td>
      <td>2.0</td>
      <td>125510.82</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>79084.10</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.duplicated().sum()
```




    0



–Ø–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ—Ç


```python
data = data.dropna()
```

–£–¥–∞–ª–∏–º –ø—Ä–æ–ø—É—Å–∫–∏, —Ç–∞–∫ —Ç–∞–∫ –∏—Ö –º–µ–Ω—å—à–µ 10%



```python
data.isna().sum()
```




    RowNumber          0
    CustomerId         0
    Surname            0
    CreditScore        0
    Geography          0
    Gender             0
    Age                0
    Tenure             0
    Balance            0
    NumOfProducts      0
    HasCrCard          0
    IsActiveMember     0
    EstimatedSalary    0
    Exited             0
    dtype: int64



–ü—Ä–∏–º–µ–Ω–∏–º OHE –∫ —Å—Ç–æ–ª–±—Ü–∞–º Geography –∏ Gender


```python
data['Geography'].unique()
```




    array(['France', 'Spain', 'Germany'], dtype=object)




```python
data['Gender'].unique()
```




    array(['Female', 'Male'], dtype=object)




```python
data = pd.get_dummies(data, columns=['Geography', 'Gender'], drop_first=True)
```

<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–°–µ–π—á–∞—Å –≤ —Ç–µ–æ—Ä–∏–∏ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞ –≤–∞–º –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å get_dummies(), –æ–¥–Ω–∞–∫–æ —ç—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ —Å–ª–æ–∂–Ω–æ—Å—Ç—è–º –≤ –±—É–¥—É—â–∏—Ö —Å–ø—Ä–∏–Ω—Ç–∞—Ö. –ü–æ—ç—Ç–æ–º—É –∑–¥–µ—Å—å —è –±—ã —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª —Ç–µ–±–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å OneHotEncoder –∏–∑ sklearn (https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html).
        
Get_dummies –ø–æ–¥—Ö–æ–¥–∏—Ç –±–æ–ª—å—à–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∞ –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª–µ–Ω OneHotEncoding, —Ç.–∫. –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å —Ä—è–¥ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π, –≤ —Ç–æ–º —á–∏—Å–ª–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ —Ä–∞–Ω–µ–µ —É—Ä–æ–≤–Ω—è–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ –±—ã–ª–æ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è –µ—â–µ –æ–¥–Ω–∞ —Å—Ç—Ä–∞–Ω–∞, —Å–∫–∞–∂–µ–º Italy). Get_dummies —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ "–∏–∑ –∫–æ—Ä–æ–±–∫–∏" –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –µ—Å—Ç—å –ª–∞–π—Ñ—Ö–∞–∫ –æ–ø–∏—Å–∞–Ω–Ω—ã–π –∑–¥–µ—Å—å: https://pythonsimplified.com/difference-between-onehotencoder-and-get_dummies/ (*Though get_dummies can‚Äôt handle unknown categories natively, you could get around this inconsistency by applying the below technique. You will have to save the columns of the train set and load it during prediction on test set. Then you need to apply reindex and after filling the missing values will get you the same features as the train set*)
        
–ü–∞–Ω–¥–∞—Å–æ–≤—Å–∫–∏–π Get_dummies –Ω–µ –∏–º–µ–µ—Ç –º–µ—Ç–æ–¥–æ–≤ fit –∏ transform, –ø–æ—ç—Ç–æ–º—É –∫–æ–¥–∏—Ä—É–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –ø–æ–ª–Ω–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ (–î–û —Ä–∞–∑–±–∏–µ–Ω–∏—è –Ω–∞ –≤—ã–±–æ—Ä–∫–∏ ... —Ç–∞–∫ –º—ã –∫—Å—Ç–∞—Ç–∏ –æ–±—Ö–æ–¥–∏–º –∏ –ø—Ä–æ–±–ª–µ–º—É "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö/–Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π"), –∑–∞—Ç–µ–º "—Ä–µ–∂–µ–º" –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≤—ã–±–æ—Ä–∫–∏.

–ù–ê–°–¢–û–Ø–¢–ï–õ–¨–ù–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø –≤ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö: –∏—Å–ø–æ–ª—å–∑—É–µ–º OneHotEncoder –∏–∑ sklearn! –í–æ—Ç —Å—Ç–∞—Ç—å—è –Ω–∞ —Ç–µ–º—É: https://datagy.io/sklearn-one-hot-encode/

p.s. (–µ—â—ë –æ–¥–∏–Ω –≤–Ω–µ—à–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫): –°–∞–º–∞—è –±–æ–ª—å—à–∞—è –æ—à–∏–±–∫–∞, –∫–æ—Ç–æ—Ä—É—é —Å–æ–≤–µ—Ä—à–∞–µ—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω–∏ –Ω–µ —Ä–∞–∑–ª–∏—á–∞—é—Ç –ø–æ—Ä—è–¥–∫–æ–≤—ã–µ –∏ –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –ü–æ—ç—Ç–æ–º—É, –µ—Å–ª–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç—É –∂–µ —Ñ—É–Ω–∫—Ü–∏—é map() –∏–ª–∏ LabelEncoder —Å –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏, –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –¥—É–º–∞—Ç—å, —á—Ç–æ –º–µ–∂–¥—É –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∫–∞–∫–∞—è-—Ç–æ —Å–≤—è–∑—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –Ω–∞—à–µ–π —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å 3 –≥–æ—Ä–æ–¥–∞: –ú–æ—Å–∫–≤–∞, –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ö–∏–µ–≤, –∑–∞–∫–æ–¥–∏—Ä—É–µ–º –≥–æ—Ä–æ–¥–∞ —á–µ—Ä–µ–∑ LabelEncoder(), –¥–æ–ø—É—Å—Ç–∏–º –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: 1, 2, 3 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –¥–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —Å–∏–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–µ—Ü–∏—Ä—É—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –Ω–∞ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—É—é –ø—Ä—è–º—É—é. –í–µ—Å—å —Å–º—ã—Å–ª –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ—Ä—è–µ—Ç—Å—è. –ë–æ–ª–µ–µ —Ç–æ–≥–æ, –ø–æ—è–≤–ª—è—é—Ç—Å—è –ª–æ–∂–Ω—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏, –∏—Å—Ö–æ–¥—è –∏–∑ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –ú–æ—Å–∫–≤–∞ + –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ = –ö–∏–µ–≤, –Ω–æ —ç—Ç–æ –Ω–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ, –∞ —Å–∫–æ—Ä–µ–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –Ω–∞–º–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏, —á—Ç–æ –º–æ–∂–µ—Ç –∑–∞–ø—É—Ç–∞—Ç—å –≤ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–∏ –º–æ–¥–µ–ª—å. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å–ø–æ—Å–æ–±–µ–Ω —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É - —ç—Ç–æ one-hot-encoding.
</div>

<div class="alert alert-success">
<b>–û–¢–õ–ò–ß–ù–û! üëç</b>

–ú–æ–ª–æ–¥–µ—Ü, —á—Ç–æ —Å–µ–π—á–∞—Å —Ç—ã –Ω–µ –∑–∞–±—ã–≤–∞–µ—à—å –ø—Ä–æ dummy-–ª–æ–≤—É—à–∫—É.
</div>


```python
#numeric = ['CreditScore', 'Balance', 'EstimatedSalary']

#scaler = StandardScaler()
#scaler.fit(data[numeric])

#data[numeric] = scaler.transform(data[numeric])
```

<div class="alert alert-danger">
<b>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å ‚ùå</b>

–ó–¥–µ—Å—å —É —Ç–µ–±—è –æ—à–∏–±–∫–∞. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–∞–∫–æ–π –≤—ã–±–æ—Ä–∫–µ –¥–æ–ª–∂–Ω–æ "–æ–±—É—á–∞—Ç—å—Å—è" –∞ –∑–∞—Ç–µ–º –¥–ª—è –∫–∞–∫–∏—Ö –≤—ã–±–æ—Ä–æ–∫ –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è?
</div>

<div style="background: #B0E0E6; padding: 5px; border: 1px solid SteelBlue; border-radius: 5px;">
    <font color='4682B4'><u><b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –°–¢–£–î–ï–ù–¢–ê</b></u></font>
    <br />
    <font color='4682B4'>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, —Å–º –ø–æ—Å–ª–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ –≤—ã–±–æ—Ä–∫–∏</font>
</div>

<div class="alert alert-success">
<b>–û–¢–õ–ò–ß–ù–û! üëç</b>

–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –æ—Ç–ª–∏—á–Ω–æ.

–•–æ—Ä–æ—à–æ, —á—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—à—å –º–µ—Ç–æ–¥ .head()/.sample() —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –≤ –ø–∞–º—è—Ç—å –Ω–µ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –≤–µ—Å—å –¥–∞—Ç–∞—Å–µ—Ç, –æ–±—ä–µ–º –∫–æ—Ç–æ—Ä–æ–≥–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–≥—Ä–æ–º–Ω—ã–º.

–ú–µ—Ç–æ–¥—ã .info, .describe, .value_counts(), .unique() –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –≤ –∑–∞–¥–∞—á–∞—Ö –ø–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö, –≤–µ–¥—å —Å –∏—Ö –ø–æ–º–æ—â—å—é –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã. 

–ò—Ç–∞–∫, –º—ã –ø—Ä–æ–≤–µ–ª–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏ –∑–∞—Ç–µ–º –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ –∏—Ö (–∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –∑–∞–ø–æ–ª–Ω–∏–ª–∏ / —É–¥–∞–ª–∏–ª–∏ / –æ—Å—Ç–∞–≤–∏–ª–∏ –∫–∞–∫ –µ—Å—Ç—å). –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∫ –∞–Ω–∞–ª–∏–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–≤–µ—Ç–∞–º –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ–µ–∫—Ç–∞.</div>

<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–ù–µ—Å–∫–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–æ–≤ "–Ω–∞ –±—É–¥—É—â–µ–µ" (—Å–µ–π—á–∞—Å –∑–∞–±–µ–≥–∞—é —á—É—Ç—å –≤–ø–µ—Ä–µ–¥, –Ω–æ –±—É–¥—É—â–µ–º —ç—Ç–æ –±—É–¥–µ—Ç –≤–∞–∂–Ω–æ) –∫–æ—Ç–æ—Ä—ã–µ —è —Ö–æ—Ç–µ–ª –æ–∑–≤—É—á–∏—Ç—å –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é:
    
- –°–î–ï–õ–ê–ù–û_–ú–û–õ–û–î–ï–¶ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –∫—Ä–∏—Ç–∏—á–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –¥–∞–Ω–Ω—ã–µ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –Ω–∞–ª–∏—á–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö (–≤–æ–ø—Ä–æ—Å: –≤—Å–µ –ª–∏ ml-–º–æ–¥–µ–ª–∏ "–ª—é–±—è—Ç" –ø—Ä–æ–ø—É—Å–∫–∏?) –∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –∏—Ö 
    
- –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —è–≤–Ω–æ –æ–±–æ–∑–Ω–∞—á–∏—Ç—å –∫–∞–∫—É—é –∑–∞–¥–∞—á—É –º—ã –±—É–¥–µ–º —Ä–µ—à–∞—Ç—å: —Å —É—á–∏—Ç–µ–ª–µ–º / –±–µ–∑ —É—á–∏—Ç–µ–ª—è, –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ / —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ ...
    
- –≤ –º–æ–¥–µ–ª—è—Ö –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤. –î–≤–∞ –≤–∑–≥–ª—è–¥–∞ (—Å —Ä–∞–∑–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω) –Ω–∞ —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É —Ç—É—Ç: https://alexanderdyakonov.wordpress.com/2021/05/27/imbalance/ –∏ https://habr.com/ru/post/349078/
    
- –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–π –∏—Ö —Å—Ç–µ–ø–µ–Ω–∏ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º–∞  –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–∏–∞—Ä–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –ü—Ä–æ–±–ª–µ–º–∞ "–º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏" —ç—Ç–æ –∏ –ø—Ä–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏ –ø—Ä–æ –µ—ë –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –ø—Ä–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ (—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –≤ –º–æ–¥–µ–ª–∏ –∏–∑–±—ã—Ç–æ—á–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö). –í —á–µ–º –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç —Å–ª–æ–∂–Ω–æ–π –º–æ–¥–µ–ª–∏? –í–æ—Ç –≤ —á–µ–º: —É—Å–ª–æ–∂–Ω—è–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –æ—Ü–µ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–µ–Ω–∞–¥–µ–∂–Ω—ã ‚Äì –ø–æ–ª—É—á–∞—é—Ç—Å—è –±–æ–ª—å—à–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–µ–Ω—è—é—Ç—Å—è —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –æ–±—ä–µ–º–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –º–æ–¥–µ–ª—å —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–µ–ø—Ä–∏–≥–æ–¥–Ω–æ–π –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è.
    
–ê —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π –ø—Ä–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å. –°–æ–≥–ª–∞—Å–∏—Å—å - —ç—Ç–æ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–¥–∞–µ—Ç –º–æ–¥–µ–ª—å –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã –ø–æ–Ω—è—Ç—å –∏ –æ–±—ä—è—Å–Ω–∏—Ç—å —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏. –í —Å–ª—É—á–∞–µ –≤–∫–ª—é—á–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª—å –∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –º–æ–∂–µ—Ç —Å–ª—É—á–∏—Ç—å—Å—è —Ç–∞–∫, —á—Ç–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (–¥–∞, –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏—Å—É—â–∞ –º–æ–¥–µ–ª—è–º –ª–∏–Ω–µ–π–Ω—ã–º ... —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å—Ä–µ–¥–∏ –Ω–∏—Ö!) –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å –∑–Ω–∞–∫–∏ –∏ –ø–æ–ø—ã—Ç–∫–∞ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é —ç—Ç–∏—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç—å –∑–¥—Ä–∞–≤–æ–º—É —Å–º—ã—Å–ª—É.
    
–í–æ—Ç –∫–ª–∞—Å—Å–Ω–∞—è —Å—Ç–∞—Ç—å—è. –ü—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º, –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –ø–æ–∫–∞–∑–∞–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞. –ê —Ç–∞–∫–∂–µ, —á—Ç–æ –≤–∞–∂–Ω–æ - —Ä–∞–∑–æ–±—Ä–∞–Ω—ã –≤–∞—Ä–∏–∞–Ω—Ç—ã –∫–∞–∫ –µ—ë (–ø—Ä–æ–±–ª–µ–º—É) –ø–æ–±–µ–¥–∏—Ç—å. –°—Ç–∞—Ç—å—è: https://habr.com/ru/company/akbarsdigital/blog/592493/ 
</div>

## –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–ò—Å—Å–ª–µ–¥—É–π—Ç–µ –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤, –æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å –±–µ–∑ —É—á—ë—Ç–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞. –ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏—Ç–µ –≤—ã–≤–æ–¥—ã


```python
data['Exited'].value_counts() #–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤
```




    0    7237
    1    1854
    Name: Exited, dtype: int64



<div class="alert alert-success">
<b>–û–¢–õ–ò–ß–ù–û! üëç</b>

–û—Ç–ª–∏—á–Ω–æ, –º–æ–ª–æ–¥–µ—Ü —á—Ç–æ –æ–±—Ä–∞—â–∞–µ—à—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö. 
</div>


```python
class_frequency = data['Exited'].value_counts(normalize=True)
print(class_frequency)
class_frequency.plot(kind='bar')
```

    0    0.796062
    1    0.203938
    Name: Exited, dtype: float64





    <AxesSubplot:>




    
![png](output_35_2.png)
    


–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ - 80/20. –ù–∞–±–ª—é–¥–∞–µ—Ç—Å—è –¥–∏—Å–±–∞–ª–∞–Ω—Å.

–†–∞–∑–¥–µ–ª–∏–º –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏, –∞ –ø–æ—Ç–æ–º –Ω–∞ –æ–±—É—á–∞—é—â—É—é, –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏(3:1:1)


```python
features = data.drop(['Exited', 'Surname', 'CustomerId', 'RowNumber'], axis=1)
target = data['Exited']

features_train, features_test, target_train, target_test = train_test_split(
    features, target, test_size=0.4, random_state=12345)

features_valid, features_test, target_valid, target_test = train_test_split(
    features_test, target_test, test_size=0.5, random_state=12345)


```

–ü—Ä–∏–º–µ–Ω–∏–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ —Å—Ç–æ–ª–±—Ü–∞–º CreditScore, Balance, EstimatedSalary


```python
numeric = ['CreditScore', 'Balance', 'EstimatedSalary']

scaler = StandardScaler()
scaler.fit(features_train[numeric])

features_train[numeric] = scaler.transform(features_train[numeric])
features_valid[numeric] = scaler.transform(features_valid[numeric])
features_test[numeric] = scaler.transform(features_test[numeric])

pd.options.mode.chained_assignment = None
```

<div class="alert alert-success">
<b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô V2</b>


–ó–¥–µ—Å—å –≤—Å—ë –≤–µ—Ä–Ω–æ. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ "–æ–±—É—á–∞–µ—Ç—Å—è" –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ, –∞ –∑–∞—Ç–µ–º –†–ï–ó–£–õ–¨–¢–ê–¢ (–æ–±—ã—á–Ω–æ —ç—Ç–æ scaler) –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∏ –∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –∏ –∫ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –∏ –∫ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∞–º.

–î–ª—è —á–µ–≥–æ –Ω—É–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–µ—Ä–µ–¥ –ø–æ–¥–∞—á–µ–π –≤ –ª–∏–Ω–µ–π–Ω—É—é –º–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä –≤ –ª–∏–Ω–µ–π–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é)? –ù–∞–º –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å –º–µ—Ç–æ–¥–æ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞. –í —Å–ª—É—á–∞–µ —Ä–∞–∑–Ω—ã—Ö –º–∞—Å—à—Ç–∞–±–æ–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥–æ–¥ —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ç–µ–π) –µ—ë –ª–∏–Ω–∏–∏ —É—Ä–æ–≤–Ω—è –±—É–¥—É—Ç –∏–º–µ—Ç—å –≤–∏–¥ –≤—ã—Ç—è–Ω—É—Ç—ã—Ö —ç–ª–ª–∏–ø—Å–æ–≤. –¢–æ–≥–¥–∞ –≤–µ–∫—Ç–æ—Ä –∞–Ω—Ç–∏–≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç —Ç–µ–∫—É—â–µ–π —Ç–æ—á–∫–∏ –∫ –º–∏–Ω–∏–º—É–º—É —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –º–æ–≥—É—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞—Ç—å, –º—ã –º–æ–∂–µ–º —É–π—Ç–∏ –¥–∞–ª–µ–∫–æ –∏ –Ω–µ –≤ —Ç—É —Å—Ç–æ—Ä–æ–Ω—É, –∏, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —à–∞–≥–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞, –ª–∏–±–æ –ø—Ä–∏–¥—ë—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å –±–æ–ª—å—à–µ –∏—Ç–µ—Ä–∞—Ü–∏–π, –ª–∏–±–æ –≤–æ–æ–±—â–µ –Ω–µ –±—É–¥–µ—Ç —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏. –ï—Å–ª–∏ –∂–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –æ—Ç–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω—ã, —Ç–æ –ª–∏–Ω–∏–∏ —É—Ä–æ–≤–Ω—è –ø–æ—Ö–æ–∂–∏ –Ω–∞ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏. –ò –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∞–Ω—Ç–∏–≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫ –º–∏–Ω–∏–º—É–º—É –Ω–µ —Ç–∞–∫ –≤—ã—Ä–∞–∂–µ–Ω–∞.
</div>

<div class="alert alert-success">
<b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô V2</b>

–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥ (—ç—Ç–æ **–ø—Å–µ–≤–¥–æ–∫–æ–¥**): 
    
    1. scaler.fit(X_train) 
    2. X_train_st = scaler.transform(X_train) 
    
–º–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–ø–∏—Å–∞—Ç—å –æ–¥–Ω–æ–π:
    
    X_train_st = scaler.fit_transform(X_train)

p.s. –Ω–æ —ç—Ç–æ **—Ç–æ–ª—å–∫–æ** –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏!    
</div>

<div style="background: #B0E0E6; padding: 5px; border: 1px solid SteelBlue; border-radius: 5px;">
    <font color='4682B4'><u><b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –°–¢–£–î–ï–ù–¢–ê</b></u></font>
    <br />
    <font color='4682B4'>–í—Ä–æ–¥–µ –ø—Ä–∏–º–µ–Ω–∏–ª pd.options.mode.chained_assignment = None. –ù–µ –ø–æ–Ω–∏–º–∞—é, –ø–æ—á–µ–º—É –≤—ã–ª–µ–∑–∞–µ—Ç SettingWithCopyWarning.</font>
</div>

<div class="alert alert-success">
<b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô V2</b>

–ò–∑–º–µ–Ω–µ–Ω–∏ –æ–ø—Ü–∏—é –ü–ï–†–ï–î –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –ø–æ—Ç–æ–º –∂–¥–∏ —á—Ç–æ —á—Ç–æ-—Ç–æ –ø–æ–º–µ–Ω—è–µ—Ç—Å—è.
</div>

<div class="alert alert-success">
<b>–û–¢–õ–ò–ß–ù–û! üëç</b>

–ó–¥–µ—Å—å –æ—Ç–ª–∏—á–Ω–æ. –í—Å—ë —Ç–∞–∫, —ç—Ç–∏ —Å—Ç–æ–ª–±—Ü—ã –º–æ–∂–Ω–æ "–±–µ–∑–±–æ–ª–µ–∑–Ω–µ–Ω–Ω–æ" –∏–∑ –Ω–∞—à–µ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ —É–¥–∞–ª–∏—Ç—å. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –≤–µ–¥—å **RowNumber** - –¥—É–±–ª–∏—Ä—É–µ—Ç –∏–Ω–¥–µ–∫—Å —Å—Ç—Ä–æ–∫–∏, –Ω–∞—á–∏–Ω–∞–µ—Ç —Å—á–µ—Ç —Å –µ–¥–∏–Ω–∏—Ü—ã, **CustomerId** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞, –æ–Ω –Ω–µ –¥–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–æ–ª–µ–∑–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, **Surname** - —Ñ–∞–º–∏–ª–∏—è - —Ç–æ–∂–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞, –Ω–æ –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ —Ñ–∞–º–∏–ª–∏–∏ –Ω–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã, —Ç–æ–∂–µ –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.
</div>

<div class="alert alert-success">
<b>–û–¢–õ–ò–ß–ù–û! üëç</b>

1. –ó–¥–µ—Å—å —Ö–æ—Ä–æ—à–æ, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ñ–∏–∫—Å–∞—Ü–∏—è random_state. –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ä–∞–∑–±–∏–µ–Ω–∏—è –≤—ã–±–æ—Ä–∫–∏ –Ω–∞ –æ–±—É—á–∞—é—â—É—é (—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é) / —Ç–µ—Å—Ç–æ–≤—É—é / –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é –º—ã –æ–±–µ—Å–ø–µ—á–∏–ª–∏, –∑–Ω–∞—á–∏—Ç –ø—Ä–∏ –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö –Ω–∞—à–µ–≥–æ –∫–æ–¥–∞ –ø–æ–¥–≤—ã–±–æ—Ä–∫–∏ –±—É–¥—É—Ç –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–º–∏.
    
2. –î–æ–ª–∏ —Ä–∞–∑–º–µ—Ä–æ–≤ train/test/valid 3:1:1 - —Ö–æ—Ä–æ—à–æ.
</div>

<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–ü—Ä–∏—Å–º–æ—Ç—Ä–∏—Å—å –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—É stratify —É —Ñ—É–Ω–∫—Ü–∏–∏ train_test_split. –ï–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª–∏—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –º–µ—Ç–æ–∫ –∫–ª–∞—Å—Å–æ–≤ 1/0 ("—É–π–¥–µ—Ç"/"–Ω–µ —É–π–¥–µ—Ç") –≤–æ –≤—Å–µ—Ö 3—Ö –≤—ã–±–æ—Ä–∫–∞—Ö (—ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –≤–∞–∂–µ–Ω **–æ—Å–æ–±–µ–Ω–Ω–æ** –≤ —Å–ª—É—á–∞–µ —Å–∏–ª—å–Ω–æ–≥–æ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö). –ù–æ –∫–æ–Ω–µ—á–Ω–æ stratify —ç—Ç–æ "–Ω–µ –ø—Ä–æ" —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–º–µ–Ω–Ω–æ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤ –∏–º–µ–Ω–Ω–æ –≤ –¥–∞–Ω–Ω—ã—Ö.
</div>

–ü—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º —Ä–∞–∑–±–∏–µ–Ω–∏–µ


```python
print(features_train.shape)
print(target_train.shape)
```

    (5454, 11)
    (5454,)



```python
print(features_valid.shape)
print(target_valid.shape)

print(features_test.shape)
print(target_test.shape)
```

    (1818, 11)
    (1818,)
    (1819, 11)
    (1819,)


<div class="alert alert-success">
<b>–û–¢–õ–ò–ß–ù–û! üëç</b>

–ú–æ–ª–æ–¥–µ—Ü, —á—Ç–æ –ø–æ—Å–ª–µ —Ä–∞–∑–±–∏–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤—ã–±–æ—Ä–∫–∏ —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ –∏—Ö —Ä–∞–∑–º–µ—Ä—ã –∏ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏. –ú–µ—Ç–æ–¥ shape –¥–ª—è —ç—Ç–æ–≥–æ - –∏–¥–µ–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫. "–¶–∏—Ñ—Ä—ã" –ø–æ –≤—ã–±–æ—Ä–∫–∞–º –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤–µ—Ä–Ω–æ –ª–∏ –º—ã –ø—Ä–æ–∏–∑–≤–µ–ª–∏ "—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ" –¥–∞–Ω–Ω—ã—Ö.

p.s. —Ç–∞–∫ (**–ø—Å–µ–≤–¥–æ–∫–æ–¥**): X_train.shape[0] ‚Äì ¬´–ø–æ–∫–∞–∂–µ—Ç¬ª –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ, –∞ X_train.shape[1] - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –Ω–µ–π –∂–µ. –ù—É –∞ X_train.shape ‚Äì –≤—ã–≤–µ–¥–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å train'–∞ –≤ –≤–∏–¥–µ –∫–æ—Ä—Ç–µ–∂–∞ —Å 2–º—è –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (–ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫, –≤—Ç–æ—Ä–æ–µ ‚Äì —Å—Ç–æ–ª–±—Ü–æ–≤).</div>

<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–ò—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∫–∞–∫ –≤–∞—Ä–∏–∞–Ω—Ç, –∞ —Ç–∞–∫–∂–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–æ–≤–µ—Ç–æ–º —Å–æ –°—Ç—ç–∫–æ–≤–µ—Ä—Ñ–ª–æ—É: https://stackoverflow.com/questions/38250710/how-to-split-data-into-3-sets-train-validation-and-test/38251213#38251213

	train, valid, test = np.split(df.sample(frac=1, random_state=821), [int(.6*len(df)), int(.8*len(df))])

–¢–∞–∫–∂–µ, —Ä–∞–∑–±–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è –±–∏–±–ª–∏–æ—Ç–µ–∫—É fast_ml (—Å–º. —Å–∫—Ä–∏–Ω). –ö —ç—Ç–æ–º—É —Å–∫—Ä–∏–Ω—É –æ–¥–∏–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π ‚Äì –Ω–µ —Ñ–∞–∫—Ç, —á—Ç–æ —ç—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ fast_ml —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –∑–¥–µ—Å—å, –Ω–∞ –•–∞–±–µ, –ù–û –¥–æ–º–∞, —Å–≤–æ–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ, —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä –ê–Ω–∞–∫–æ–Ω–¥–æ–π: https://www.anaconda.com/products/distribution) —Ç—ã –≤–ø–æ–ª–Ω–µ –º–æ–∂–µ—à—å —ç—Ç–∏–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è (–ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ **!pip install fast_ml**):
</div>

![image.png](attachment:image.png)

DecisionTreeClassifier


```python
best_model_dt = None
best_result_dt = 0
for depth in range(1, 11):
    model_dt = DecisionTreeClassifier(random_state=12345, max_depth=depth)
    model_dt.fit(features_train, target_train)
    predictions_valid_dt = model_dt.predict(features_valid)
    result_dt = f1_score(target_valid, predictions_valid_dt)
    if result_dt > best_result_dt:
        best_model_dt = model_dt
        best_depth_dt = depth
        best_result_dt = result_dt

print(best_model_dt) 
print('f1:', result_dt)
```

    DecisionTreeClassifier(max_depth=7, random_state=12345)
    f1: 0.5130568356374808


<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–µ—Ä–µ–±—Ä–∞—Ç—å –≤ —Ü–∏–∫–ª–µ 2-3 –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞. –û–¥–Ω–æ–≥–æ, –∫–∞–∫ –¥–ª—è "–¥–µ—Ä–µ–≤–∞", —Ç–∞–∫ –∏ "–ª–µ—Å–∞" –º–∞–ª–æ - —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞–≤–µ—Ä–Ω—è–∫–∞ –±—É–¥–µ—Ç –Ω–∏–∑–∫–æ–π. –í –∏—Ç–æ–≥–µ –ø–æ–ª—É—á–∏—à—å —Å—Ä–∞–∑—É –¥–≤–∞ –ø–ª—é—Å–∞: –ø–æ—Ç—Ä–µ–Ω–∏—Ä—É–µ—à—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏ –ø–æ–ª—É—á–∏—à—å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π!
</div>

<div class="alert alert-success">
<b>–û–¢–õ–ò–ß–ù–û! üëç</b>

–ò—Ç–∞–∫, –∫ —ç—Ç–æ–º—É –º–æ–º–µ–Ω—Ç—É –º—ã –∑–Ω–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∞–∫—Ç—ã –æ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö:

1. –¥–∞–Ω–Ω—ã–µ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã (–∑–∞–ø–∏—Å–µ–π —Å –∫–ª–∞—Å—Å–æ–º == 0 –≤ 4 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ —á–µ–º –¥–∞–Ω—ã—Ö —Å –∫–ª–∞—Å—Å–æ–º == 1).

2. —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó –ó–∞–∫–∞–∑—á–∏–∫–∞ –Ω–∞–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å —É—Å–ª–æ–≤–∏–µ, —á—Ç–æ f1-–º–µ—Ä–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0.59

3. –∏–∑ —Ç–µ–æ—Ä–∏–∏ –≤ –¢—Ä–µ–Ω–∞–∂–µ—Ä–µ –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ –º–µ—Ç—Ä–∏–∫–∞ **accuracy_score –ù–ï –ü–û–ö–ê–ó–ê–¢–ï–õ–¨–ù–ê** –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –º–æ–¥–µ–ª–µ–π (–≤ –∑–∞–¥–∞—á–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏) –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –Ω–∞ –¥–∞–Ω–Ω—ã—Ö —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤.

–ù—É –∏ –∑–¥–µ—Å—å —Ç—ã –º–æ–ª–æ–¥–µ—Ü, —á—Ç–æ —Å—á–∏—Ç–∞–µ—à—å —á—Ç–æ-—Ç–æ –∏–∑ –Ω–∞–±–æ—Ä–∞ (–ø–æ–ª–Ω–æ—Ç–∞ / —Ç–æ—á–Ω–æ—Å—Ç—å / f1-–º–µ—Ä–∞ / roc-auc).  
    
p.s. –º–æ–∂–Ω–æ –µ—â—ë –º–∞—Ç—Ä–∏—Ü—É –æ—à–∏–±–æ–∫ (confusion matrix) –ø–æ—Å—Ç—Ä–æ–∏—Ç—å.
</div>

RandomForestClassifier


```python
best_model_rf = None
best_result_rf = 0
best_est_rf = 0
best_depth_rf = 0
for est in tqdm(range(1, 11)):
    for depth in range(1, 11):
        model_rf = RandomForestClassifier(random_state=12345, n_estimators=est, max_depth=depth)
        model_rf.fit(features_train, target_train)
        predictions_valid_rf = model_rf.predict(features_valid)
        result_rf = f1_score(predictions_valid_rf, target_valid)
        if result_rf > best_result_rf:
            best_model_rf = model_rf
            best_result_rf = result_rf
            best_est_rf = est
            best_depth_rf = depth
            
print(best_model_rf)
print('f1:', result_rf)
```

    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:02<00:00,  4.05it/s]

    RandomForestClassifier(max_depth=4, n_estimators=1, random_state=12345)
    f1: 0.5551839464882943


    


LogisticRegression


```python
model_lr = LogisticRegression(random_state=12345, solver='liblinear')
model_lr.fit(features_train, target_train)
predictions_valid_lr = model_lr.predict(features_valid)

print("f1:", f1_score(target_valid, predictions_valid_lr))
```

    f1: 0.3046092184368738


–ù–∞–∏–≤—ã—Å—à–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å f1 —É –º–æ–¥–µ–ª–∏ RandomForestClassifier.

<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Ç—Ä–µ–±—É–µ–º–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó: f1 > 0.59 –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ) - —Ç–æ–∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
    
–î–º–∏—Ç—Ä–∏–π, —è –Ω–µ –±—É–¥—É –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–ª–µ–µ —Ä—É—Ç–∏–Ω–Ω—ã–µ (–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º –º–µ–Ω—è—é—â–∏—Ö—Å—è –Ω–∞–∑–≤–∞–Ω–∏–π –º–æ–¥–µ–ª–µ–π, –¥–µ–π—Å—Ç–≤–∏—è). –ï—Å–ª–∏ —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫—É —É–≤–∏–∂—É - —Ç–æ–≥–¥–∞ –Ω–∞–ø–∏—à—É. –ê —Ç–∞–∫, —Å–º–æ—Ç—Ä—é –∑–∞ —Ö–æ–¥–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è + –≤–æ–∑–º–æ–∂–Ω–æ –≥–¥–µ-—Ç–æ —Å–≤–æ–∏ –º—ã—Å–ª–∏/—Å–æ–≤–µ—Ç—ã/—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —É–∫–∞–∂—É.    
</div>

## –ë–æ—Ä—å–±–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º

–£–ª—É—á—à–∏—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏, —É—á–∏—Ç—ã–≤–∞—è –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤. –û–±—É—á–∏—Ç–µ —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –Ω–∞–π–¥–∏—Ç–µ –ª—É—á—à—É—é. –ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏—Ç–µ –≤—ã–≤–æ–¥—ã.

–ü—Ä–∏–º–µ–Ω–∏–º –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤

<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–û—Ç–º–µ—Ç—å —Ç–∞–∫–æ–π –º–æ–º–µ–Ω—Ç (—Å–µ–π—á–∞—Å —ç—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞ –≤ —Ç–≤–æ–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ—Ç ... —è –ø—Ä–æ—Å—Ç–æ —Ä–∞—Å—Å—É–∂–¥–∞—é): —Å–æ–≤–º–µ—â–∞—Ç—å up(down)sampling –∏ class_weight –Ω–µ–ª—å–∑—è.

–í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –¥–∞—ë—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≤–µ—Å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –º–∞–ª–æ–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–∞–º, –∂–µ—Ä—Ç–≤—É—è —Ç–æ—á–Ω–æ—Å—Ç—å—é –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è –º–Ω–æ–≥–æ–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –≤ –ø–æ–ª—å–∑—É —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è –º–∞–ª–æ–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ (—É–º–µ–Ω—å—à–µ–Ω–∏–µ) –≤—ã–±–æ—Ä–∫–∏ –¥–µ–ª–∞–µ—Ç –ø–æ —Å—É—Ç–∏ —Ç–æ –∂–µ —Å–∞–º–æ–µ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏ –¥–∞–µ—Ç –±–æ–ª—å—à–∏–π –≤–µ—Å –¥—É–±–ª–∏—Ä—É–µ–º–æ–º—É –∫–ª–∞—Å—Å—É). –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ä–∞–∑—É –¥–≤—É—Ö –º–µ—Ç–æ–¥–æ–≤ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–µ–ª–æ –±—ã –Ω–æ–≤–æ–º—É –¥–∏—Å–±–∞–ª–∞–Ω—Å—É, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã –Ω—É–∂–Ω–æ –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∞—é—â–µ.
</div>

DecisionTreeClassifier


```python
best_model_dt = None
best_result_dt = 0
for depth in range(1, 11):
    model_dt = DecisionTreeClassifier(random_state=12345, max_depth=depth, class_weight='balanced')
    model_dt.fit(features_train, target_train)
    predictions_valid_dt = model_dt.predict(features_valid)
    result_dt = f1_score(target_valid, predictions_valid_dt)
    if result_dt > best_result_dt:
        best_model_dt = model_dt
        best_depth = depth
        best_result_dt = result_dt
        
print(best_model_dt)
print('f1:', result_dt)
```

    DecisionTreeClassifier(class_weight='balanced', max_depth=5, random_state=12345)
    f1: 0.5164113785557987


RandomForestClassifier


```python
best_model_rf = None
best_result_rf = 0
best_est_rf = 0
best_depth_rf = 0
for est in tqdm(range(1, 11)):
    for depth in range(1, 11):
        model_rf = RandomForestClassifier(random_state=12345, n_estimators=est, max_depth=depth, class_weight='balanced')
        model_rf.fit(features_train, target_train)
        predictions_valid_rf = model_rf.predict(features_valid)
        result_rf = f1_score(predictions_valid_rf, target_valid)
        if result_rf > best_result_rf:
            best_model_rf = model_rf
            best_result_rf = result_rf
            best_est_rf = est
            best_depth_rf = depth
            
print(best_model_rf)
print('f1:', result_rf)

```

    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10/10 [00:02<00:00,  4.01it/s]

    RandomForestClassifier(class_weight='balanced', max_depth=9, n_estimators=10,
                           random_state=12345)
    f1: 0.5840707964601769


    


LogisticRegression


```python
model_lr = LogisticRegression(random_state=12345, solver='liblinear', class_weight='balanced')
model_lr.fit(features_train, target_train)
predictions_valid_lr = model_lr.predict(features_valid)

print("f1:", f1_score(target_valid, predictions_valid_lr))
```

    f1: 0.5101289134438306


–°–¥–µ–ª–∞–µ–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏

<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–û—Ç–º–µ—Ç—å 2 —Ç–∞–∫–∏—Ö –º–æ–º–µ–Ω—Ç–∞ (—Å–µ–π—á–∞—Å —ç—Ç–∏—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–≤ –≤ —Ç–≤–æ–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ—Ç ... —è –ø—Ä–æ—Å—Ç–æ —Ä–∞—Å—Å—É–∂–¥–∞—é): –µ—Å–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ "–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ" –≤—ã–±–æ—Ä–∫–∏ —Å –∫–ª–∞—Å—Å–æ–º == 1 (–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–ª–∏ –∫–ª–∞—Å—Å—ã), –∞ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ, —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –±—ã –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é (–Ω–∞ —É–∂–µ —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö) —Ç–æ –º–æ–≥–ª–∏ –±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—á–µ–Ω—å "–æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π", –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –±—ã —É –Ω–∞—Å –±—ã–ª–∞ –æ—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞) –∏–ª–∏ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª—å –µ—â—ë –Ω–µ –≤–∏–¥–µ–ª–∞), —Ç.–µ results are overly optimistic and do not generalize to new data well. –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—å—é (—Å –∫–æ–¥–æ–º): https://kiwidamien.github.io/how-to-do-cross-validation-when-upsampling-data.html 
    
–ò –≤—Ç–æ—Ä–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∫ "—Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏—é" –¥–∞–Ω–Ω—ã—Ö (–ø–æ–≤—Ç–æ—Ä—é—Å—å - —ç—Ç–æ –ø–æ –º–æ–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è–º –∑–∞ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —ç—Ç–æ–≥–æ —Ç–∏–ø–∞ ... —É —Ç–µ–±—è –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø–æ–¥–æ–±–Ω–æ–π –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ—Ç, –ú–û–õ–û–î–ï–¶!): upsampling –º—ã –¥–æ–ª–∂–Ω—ã –¥–µ–ª–∞—Ç—å **–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ** –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ! –ù–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –∏/–∏–ª–∏ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ –ù–ï –¥–µ–ª–∞–µ–º!
</div>

DecisionTreeClassifier


```python
def upsample(features, target, repeat):
    features_zeros = features[target == 0]
    features_ones = features[target == 1]
    target_zeros = target[target == 0]
    target_ones = target[target == 1]

    features_upsampled = pd.concat([features_zeros] + [features_ones] * repeat)
    target_upsampled = pd.concat([target_zeros] + [target_ones] * repeat)
    
    features_upsampled, target_upsampled = shuffle(
        features_upsampled, target_upsampled, random_state=12345)
    
    return features_upsampled, target_upsampled

features_upsampled, target_upsampled = upsample(features_train, target_train, 4)

model_dt = DecisionTreeClassifier(random_state=12345, max_depth=depth)
model_dt.fit(features_upsampled, target_upsampled)
predictions_valid_dt = model_dt.predict(features_valid)

print("f1:", f1_score(target_valid, predictions_valid_dt))
```

    f1: 0.5059978189749182


<div class="alert alert-success">
<b>–û–¢–õ–ò–ß–ù–û! üëç</b>

–û—Ç–ª–∏—á–Ω–æ! –ö—Ä–∞—Å–∏–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –ù—É –∏ –∑–¥–æ—Ä–æ–≤–æ —á—Ç–æ —Ç—ã –ø–æ–Ω–∏–º–∞–µ—à—å, —á—Ç–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π —É–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥, –¥–µ–ª–∞–µ—Ç –µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º, –ø—Ä–æ—Å—Ç—ã–º –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏ —É–ø—Ä–æ—â–∞–µ—Ç –µ–≥–æ –¥–∞–ª—å–Ω–µ–π—à–µ–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–ø—Ä–∏–Ω—Ü–∏–ø DRY (Don‚Äôt Repeat Yourself / –ù–µ –ø–æ–≤—Ç–æ—Ä—è–π—Å—è) ‚Äì –≤ –¥–µ–π—Å—Ç–≤–∏–∏). –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ DRY –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –∑–¥–µ—Å—å: https://habr.com/ru/company/itelma/blog/546372</div>

<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–û—á–µ–Ω—å —á–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞ –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö (–Ω–æ –≤ —Ç–≤–æ–µ–º —Å–ª—É—á–∞–µ –≤—Å—ë –≤–µ—Ä–Ω–æ, –º–æ–ª–æ–¥–µ—Ü) - –∫–æ–ª–ª–µ–≥–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –±–µ—Ä—É—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 10. –¢–æ –µ—Å—Ç—å, –æ–Ω–∏ —Å–º–æ—Ç—Ä—è—Ç –Ω–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –±–µ—Ä—É—Ç –Ω–µ —Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª–∏—Ç –≤—ã–±–æ—Ä–∫–∏ "–≤—ã—Ä–æ–≤–Ω—è—Ç—å", –∞ –µ—â—ë –±–æ–ª—å—à–µ —Ä–∞–∑–±–∞–ª–∞–Ω—Å–∏—Ä—É–µ—Ç –∏—Ö ... —Ç–æ–ª—å–∫–æ –≤ –¥—Ä—É–≥—É—é —Å—Ç–æ—Ä–æ–Ω—É.  

–ù—É –∏ –ø—Ä–∏ –¥–∞—É–Ω—Å–∞–º–ø–ª–∏–Ω–≥–µ, —á–∞—Å—Ç–æ –≤–º–µ—Å—Ç–æ 0.25 –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 0.1
</div>

RandomForestClassifier


```python
def upsample(features, target, repeat):
    features_zeros = features[target == 0]
    features_ones = features[target == 1]
    target_zeros = target[target == 0]
    target_ones = target[target == 1]

    features_upsampled = pd.concat([features_zeros] + [features_ones] * repeat)
    target_upsampled = pd.concat([target_zeros] + [target_ones] * repeat)
    
    features_upsampled, target_upsampled = shuffle(
        features_upsampled, target_upsampled, random_state=12345)
    
    return features_upsampled, target_upsampled

features_upsampled, target_upsampled = upsample(features_train, target_train, 4)

model_rf = RandomForestClassifier(random_state=12345, n_estimators=est, max_depth=depth)
model_rf.fit(features_upsampled, target_upsampled)
predictions_valid_rf = model_rf.predict(features_valid)

print("f1:", f1_score(target_valid, predictions_valid_rf))
```

    f1: 0.5952380952380951


<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–ê –∑–∞—á–µ–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—à—å —Ñ—É–Ω–∫—Ü–∏—é 3 —Ä–∞–∑–∞? –§—É–Ω–∫—Ü–∏—è –Ω–∞ —Ç–æ –∏ –µ—Å—Ç—å, —á—Ç–æ–±—ã –±—É–¥—É—á–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π 1 —Ä–∞–∑ - –º–æ–≥–ª–∞ –≤—ã–∑—ã–≤–∞—Ç—å—Å—è (–≤ —Ç–æ–º —á–∏—Å–ª–µ –∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏) –º–Ω–æ–≥–æ —Ä–∞–∑.
</div>

LogisticRegression


```python
def upsample(features, target, repeat):
    features_zeros = features[target == 0]
    features_ones = features[target == 1]
    target_zeros = target[target == 0]
    target_ones = target[target == 1]

    features_upsampled = pd.concat([features_zeros] + [features_ones] * repeat)
    target_upsampled = pd.concat([target_zeros] + [target_ones] * repeat)
    
    features_upsampled, target_upsampled = shuffle(
        features_upsampled, target_upsampled, random_state=12345)
    
    return features_upsampled, target_upsampled

features_upsampled, target_upsampled = upsample(features_train, target_train, 4)

model_lr = LogisticRegression(random_state=12345, solver='liblinear')
model_lr.fit(features_upsampled, target_upsampled)
predicted_valid = model_lr.predict(features_valid)

print("f1:", f1_score(target_valid, predicted_valid))
```

    f1: 0.5072463768115941


–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∞–ø—Å—ç–º–ø–ª–∏–Ω–≥–∞ —Ç–∞–∫–∂–µ –ª—É—á—à–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å f1 —É –º–æ–¥–µ–ª–∏ RandomForestClassifier. –ù–∞ –Ω–µ–π –∏ –ø—Ä–æ–≤–µ–¥–µ–º —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

<div class="alert alert-success">
<b>–û–¢–õ–ò–ß–ù–û! üëç</b>

–ó–¥–µ—Å—å –æ—Ç–ª–∏—á–Ω–æ: –ø–æ–¥–æ–±—Ä–∞–ª–∏ –¥–ª—è –≤—Å–µ—Ö –Ω–∞—à–∏—Ö –º–æ–¥–µ–ª–µ–π –ª—É—á—à–∏–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ - –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É—é—â–∏–µ f1-–º–µ—Ä—É –∏(?) AUC ("–ø–ª–æ—â–∞–¥—å"). –¢–∞–∫–∂–µ –∑–¥–µ—Å—å –º—ã –µ—â—ë –∏ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ –°–ê–ú–£–Æ –ª—É—á—à—É—é –º–æ–¥–µ–ª—å. –ù–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –µ—é –æ–∫–∞–∑–∞–ª–∞—Å—å –º–æ–¥–µ–ª—å "—Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞". 

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–¥–æ–±—Ä–∞–Ω—ã - —Ç–µ—Å—Ç–∏—Ä—É–µ–º –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Ç–µ—Å—Ç–µ (—Å–æ—Ä—Ä–∏ –∑–∞ —Ç–∞–≤—Ç–∞–ª–æ–≥–∏—é) –≤—ã–±–∏—Ä–∞–µ–º –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä—É—é —Å–º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–Ω. 
</div>

<div class="alert alert-warning">
<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π üëâ</b>

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∫–∞–∫ –µ—â—ë –æ–¥–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SMOTE (—Å—Ç–∞—Ç—å–∏: https://imbalanced-learn.org/stable/references/generated/imblearn.over_sampling.SMOTE.html –∏–ª–∏ https://habr.com/ru/articles/461285/) –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –≤—ã–±–æ—Ä–∫–∏ –∏ RandomUnderSampler (—Å—Ç–∞—Ç—å—è: https://imbalanced-learn.org/stable/references/generated/imblearn.under_sampling.RandomUnderSampler.html) –ª–∏–±–æ –≤–º–µ—Å—Ç–æ (–ª–∏–±–æ –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–∏) –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –∏–∑ —Ç—Ä–µ–Ω–∞–∂–µ—Ä–∞.
</div>

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.


```python
model_best = RandomForestClassifier(
    random_state=12345, max_depth = 9, n_estimators = 10, class_weight='balanced')

model_best.fit(features_train, target_train) 
predictions = model_best.predict(features_test)
result = f1_score(target_test, predictions)

print("f1 –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:", result)
```

    f1 –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.5936675461741425


<div class="alert alert-danger">
<b>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å ‚ùå</b>

–ù–∞ –∫–∞–∫–æ–π –≤—ã–±–æ—Ä–∫–µ —Ç–µ—Å—Ç–∏—Ä—É–µ—à—å –º–æ–¥–µ–ª—å? –ê –Ω–∞ –∫–∞–∫–æ–π –Ω–∞–¥–æ —ç—Ç–æ –¥–µ–ª–∞—Ç—å?
</div>

<div style="background: #B0E0E6; padding: 5px; border: 1px solid SteelBlue; border-radius: 5px;">
    <font color='4682B4'><u><b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –°–¢–£–î–ï–ù–¢–ê</b></u></font>
    <br />
    <font color='4682B4'>–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ</font>
</div>

<div class="alert alert-success">
<b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô V2</b>

+
</div>

–ó–Ω–∞—á–µ–Ω–∏–µ f1 –ø—Ä–µ–≤—ã—à–∞–µ—Ç —Ç—Ä–µ–±—É–µ–º—ã–µ 0.59


```python
probabilities_valid = model_best.predict_proba(features_valid)
probabilities_one_valid = probabilities_valid[:, 1]

fpr, tpr, thresholds = roc_curve(target_valid, probabilities_one_valid)

plt.figure()

plt.plot(fpr, tpr)

plt.plot([0, 1], [0, 1], linestyle='--')

plt.xlim([0.0, 1.0])
plt.ylim([0.0, 1.0])

plt.xlabel('False Positive Rate')
plt.ylabel('True Positive Rate')

plt.title('ROC-–∫—Ä–∏–≤–∞—è')
plt.show()

auc_roc = roc_auc_score(target_valid, probabilities_one_valid)
print('auc_roc:', auc_roc)
```


    
![png](output_94_0.png)
    


    auc_roc: 0.8689634924170329


<div class="alert alert-success">
<b>–û–¢–õ–ò–ß–ù–û! üëç</b>

–ó–¥–µ—Å—å —Ö–æ—Ä–æ—à–æ. –†–∞—Å—á—ë—Ç ROC-AUC –≤—ã–ø–æ–ª–Ω–µ–Ω –≤–µ—Ä–Ω–æ, —á–µ—Ä–µ–∑ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∞ 1. 
    
–ü–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π (Area Under Curve ‚Äì –ø–ª–æ—â–∞–¥—å –ø–æ–¥ –∫—Ä–∏–≤–æ–π, Receiver Operating Characteristic ‚Äì —Ä–∞–±–æ—á–∞—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ –ø—Ä–∏—ë–º–Ω–∏–∫–∞ ... –ø—Ä–∏—à–ª–æ –∏–∑ –æ–±–ª–∞—Å—Ç–∏ —Ä–∞–¥–∏–æ—ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏) ‚Äì —ç—Ç–æ –º–µ—Ç—Ä–∏–∫–∞ –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –∑–∞–¥–∞—á –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. ROC-–∫—Ä–∏–≤–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –¥–æ–ª–µ–π –≤–µ—Ä–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏ –¥–æ–ª–µ–π –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤. –ù—É –∏ —Å–∞–º–∞ –ø–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π —è–≤–ª—è–µ—Ç—Å—è –º–µ—Ä–æ–π –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞: —á–µ–º –≤—ã—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ AUC (Area Under Curve), —Ç–µ–º –ª—É—á—à–µ –∫–∞—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏. –ù–∞—à –≥–ª–∞–∑ –∏ –º–æ–∑–≥ —É—Å—Ç—Ä–æ–µ–Ω—ã —Ç–∞–∫, —á—Ç–æ –º—ã –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ –≤–∏–¥–∏–º –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é —Ä–∞–∑–Ω–∏—Ü—É (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–ª–æ—â–∞–¥–µ–π).
</div>

–£–¥–∞–ª–æ—Å—å –¥–æ—Å—Ç–∏—á—å —Ç—Ä–µ–±—É–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è f1, –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å auc_roc –±–ª–∏–∑–æ–∫ –∫ –µ–¥–∏–Ω–∏—Ü–µ, —ç—Ç–æ –≤—ã—à–µ —Å–ª—É—á–∞–π–Ω—ã—Ö 0.5

–í—ã–≤–æ–¥: –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ç—Ä–µ—Ö –º–æ–¥–µ–ª–µ–π –º—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –ª—É—á—à—É—é - —ç—Ç–æ RandomForestClassifier. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–∞–±–ª—é–¥–∞–ª—Å—è –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤(80/20), –∫–æ—Ç–æ—Ä—ã–π –º—ã —É—Å—Ç—Ä–∞–Ω–∏–ª–∏ —Å –ø–æ–º–æ—â—å—é –∏—Ö –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è –∏ –∞–ø—Å—ç–º–ø–ª–∏–Ω–≥–∞. –£–¥–∞–ª–æ—Å—å –¥–æ–±–∏—Ç—å—Å—è –ø–æ–≤—ã—à–µ–Ω–∏—è F1-–º–µ—Ä—ã. –í –∏—Ç–æ–≥–µ –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–∞–º —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ç—Ä–µ–±—É–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ f1 - 0.59, –∑–Ω–∞—á–µ–Ω–∏–µ auc_roc —Ç–∞–∫–∂–µ –≤—ã—à–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏.

<div class="alert alert-danger">
<b>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å ‚ùå</b>

–ù–∞–ø–∏—à–∏ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ –ø–æ –ø—Ä–æ–µ–∫—Ç—É. –ó–¥–µ—Å—å —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –¥–µ–ª–∞–ª–∏, –∫–∞–∫–∏–º–∏ —à–∞–≥–∞–º–∏, –∫ —á–µ–º—É –ø—Ä–∏—à–ª–∏ (—Å —Ü–∏—Ñ—Ä–∞–º–∏ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–æ–π).
</div>

<div style="background: #B0E0E6; padding: 5px; border: 1px solid SteelBlue; border-radius: 5px;">
    <font color='4682B4'><u><b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô –°–¢–£–î–ï–ù–¢–ê</b></u></font>
    <br />
    <font color='4682B4'>–í—ã–≤–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω</font>
</div>

<div class="alert alert-success">
<b>–ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô V2</b>


–í—Å—ë –æ—Ç–ª–∏—á–Ω–æ, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç.
    
–û–¥–∏–Ω —Å–æ–≤–µ—Ç (—Ç–∞–∫–∂–µ, –Ω–∞ –±—É–¥—É—â–µ–µ): –∫–∞–∫ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è —É–ª—É—á—à–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Å –º–∏–Ω–∏–º—É–º —É—Å–∏–ª–∏–π? –û—Ç–≤–µ—Ç: –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ train –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏, –∞ valid - –¥–ª—è –ø–æ–∏—Å–∫–∞ –ª—É—á—à–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –õ—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—à–ª–∏. –¢–∞–∫ –ø–æ—á–µ–º—É –±—ã —Ç–µ–ø–µ—Ä—å –Ω–∞—à–∏ –º–æ–¥–µ–ª–∏ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–µ –æ–±—É—á–∏—Ç—å –Ω–∞ *–æ–±—â–µ–π* (—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π + –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π) –≤—ã–±–æ—Ä–∫–µ (pd.concat() –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è). –ß–µ–º –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö, —Ç–µ–º *–ª—É—á—à–µ* –º–æ–¥–µ–ª–∏ —Å–º–æ–≥—É—Ç –æ–±—É—á–∏—Ç—å—Å—è (–Ω–∞–¥–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å!). –ò –≤–æ—Ç —Ç–µ–ø–µ—Ä—å —ç—Ç—É –¥–æ–æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å –º—ã —É–∂–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏–º –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ (test).

–ù–æ —Å–ª–µ–¥—É–µ—Ç —É—á–µ—Å—Ç—å –≤–æ—Ç –∫–∞–∫–æ–π –º–æ–º–µ–Ω—Ç: –Ω—É–∂–Ω–æ –±—ã—Ç—å –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–º —Å –ø–æ–¥–æ–±–Ω—ã–º ¬´—É–ª—É—á—à–µ–Ω–∏–µ–º¬ª, –µ—Å–ª–∏ –º—ã –∫–æ–¥–∏—Ä—É–µ–º –∏–ª–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –Ω–∞—à–∏ –≤—ã–±–æ—Ä–∫–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–æ–µ–∫—Ç–µ –º—ã –æ–±—É—á–∞–µ–º—Å—è –Ω–∞ train‚Äô–µ, –∞ –∑–∞—Ç–µ–º –¥–µ–ª–∞–µ–º transform –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–µ. –ï—Å–ª–∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ç—Ä–µ–π–Ω –∏ –≤–∞–ª–∏–¥, —Ç–æ —ç—Ç–æ –±—É–¥–µ—Ç –Ω–µ —Å–æ–≤—Å–µ–º –≤–µ—Ä–Ω–æ.
</div>

## –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ—Å—Ç–∞–≤—å—Ç–µ 'x' –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–∞—Ö. –î–∞–ª–µ–µ –Ω–∞–∂–º–∏—Ç–µ Shift+Enter.

- [x]  Jupyter Notebook –æ—Ç–∫—Ä—ã—Ç
- [x]  –í–µ—Å—å –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [x]  –Ø—á–µ–π–∫–∏ —Å –∫–æ–¥–æ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –ø–æ—Ä—è–¥–∫–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- [x]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 1: –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã
- [x]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 2: –∑–∞–¥–∞—á–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∞
    - [x]  –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤
    - [x]  –ò–∑—É—á–µ–Ω—ã –º–æ–¥–µ–ª–∏ –±–µ–∑ —É—á—ë—Ç–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞
    - [x]  –ù–∞–ø–∏—Å–∞–Ω—ã –≤—ã–≤–æ–¥—ã –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
- [x]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 3: —É—á—Ç—ë–Ω –¥–∏—Å–±–∞–ª–∞–Ω—Å
    - [x]  –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º
    - [x]  –ù–∞–ø–∏—Å–∞–Ω—ã –≤—ã–≤–æ–¥—ã –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
- [x]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 4: –ø—Ä–æ–≤–µ–¥–µ–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x]  –£–¥–∞–ª–æ—Å—å –¥–æ—Å—Ç–∏—á—å *F1*-–º–µ—Ä—ã –Ω–µ –º–µ–Ω–µ–µ 0.59
- [x]  –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∞ –º–µ—Ç—Ä–∏–∫–∞ *AUC-ROC*

# –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ–≤—å—é:

–Ø –æ—Ç–º–µ—á–∞—é –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —Ç–≤–æ–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—Å–∫–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏. –¢—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —è–∑—ã–∫–∞ Python, –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ pandas –∏ –æ–¥–Ω–æ–π –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è sckit-learn. –í—Å—ë —ç—Ç–æ –≤ —Ü–µ–ª–æ–º —É–ø—Ä–æ—â–∞–µ—Ç —Ç–≤–æ–π –∫–æ–¥ –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –≤–ª–∞–¥–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ machine learning.

–° –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º –Ω–µ—Ç. –¢–≤–æ–∏—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ç–≤–æ–∏–º–∏ –∫–æ–ª–ª–µ–≥–∞–º–∏ —Ö–æ–¥–∞ –º—ã—Å–ª–µ–π. –°—Å—ã–ª–∫–∏ –∏–∑ –±—Ä–∏—Ñ–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –Ω—É–∂–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö —Ç–∞–∫–∂–µ –ø–æ–º–æ–≥–∞—é—Ç —Å–ª–µ–¥–æ–≤–∞—Ç—å –∑–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ–º —Å–æ–±—ã—Ç–∏–π –∏ –¥–∞—é—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–∞—Å–∞–µ–º–æ —Ç–æ–≥–æ, —á—Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –≤ —Ç–æ–º –∏–ª–∏ –∏–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø—Ä–æ–µ–∫—Ç–∞.

–ó–µ–ª—ë–Ω—ã–º —Ü–≤–µ—Ç–æ–º —è –æ—Ç–º–µ—Ç–∏–ª –∏ –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª —É–¥–∞—á–Ω—ã–µ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –º–æ–∂–µ—à—å –æ–ø–∏—Ä–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.

–ñ—ë–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º —è –≤—ã–¥–µ–ª–∏–ª —Ç–æ, —á—Ç–æ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É. –¢—ã –º–æ–∂–µ—à—å —É—á–µ—Å—Ç—å —ç—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –±—É–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π –∏–ª–∏ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–µ–∫—Ç —Å–µ–π—á–∞—Å.

–û–¥–Ω–∞–∫–æ –µ—Å—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –º–Ω–µ –ø—Ä–∏–Ω—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –≤ –µ–≥–æ –Ω—ã–Ω–µ—à–Ω–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏:

<div class="alert alert-danger">
<b>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å ‚ùå</b> 

1. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–∞–∫–æ–π –≤—ã–±–æ—Ä–∫–µ –¥–æ–ª–∂–Ω–æ "–æ–±—É—á–∞—Ç—å—Å—è" –∞ –∑–∞—Ç–µ–º –¥–ª—è –∫–∞–∫–∏—Ö –≤—ã–±–æ—Ä–æ–∫ –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è?

2. –ù–µ –≤—Å–µ –Ω–µ–Ω—É–∂–Ω—ã–µ –¥–ª—è –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –¥–∞–Ω–Ω—ã—Ö.
    
3. –ù–∞ –∫–∞–∫–æ–π –≤—ã–±–æ—Ä–∫–µ —Ç–µ—Å—Ç–∏—Ä—É–µ—à—å –º–æ–¥–µ–ª—å? –ê –Ω–∞ –∫–∞–∫–æ–π –Ω–∞–¥–æ —ç—Ç–æ –¥–µ–ª–∞—Ç—å?    

4. –§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ –ø–æ –ø—Ä–æ–µ–∫—Ç—É –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç. –•–æ—Ç–µ–ª–æ—Å—å –±—ã —É–≤–∏–¥–µ—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –¥–µ–ª–∞–ª–∏, –∫–∞–∫–∏–º–∏ —à–∞–≥–∞–º–∏, –∫ —á–µ–º—É –ø—Ä–∏—à–ª–∏ (—Å —Ü–∏—Ñ—Ä–∞–º–∏ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–æ–π).    
</div>

–≠—Ç–∏ 4 –º–æ–º–µ–Ω—Ç–∞ —Ç—Ä–µ–±—É—é—Ç —Ç–≤–æ–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ –Ω–∏–º –ø–æ–º–µ—á–µ–Ω—ã –∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º. 

–ü–æ–¥–≤–æ–¥—è –∏—Ç–æ–≥: —Ö–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ —Å–∞–º–æ–º-—Ç–æ –¥–µ–ª–µ, –º–æ–ª–æ–¥–µ—Ü! –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–æ–≤ –∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é, –Ω–æ —É–≤–µ—Ä–µ–Ω, —á—Ç–æ –æ–Ω–∏ –Ω–µ –≤—ã–∑–æ–≤—É—Ç —É —Ç–µ–±—è —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π. –ü–æ—Å–ª–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –≤—ã–≤–æ–¥—ã. –ò—Ö –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å. –ñ–¥—É –¥–æ—Ä–∞–±–æ—Ç–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–µ–≤—å—é.
