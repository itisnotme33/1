
<h1>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞" data-toc-modified-id="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞</a></span></li><li><span><a href="#–ê–Ω–∞–ª–∏–∑" data-toc-modified-id="–ê–Ω–∞–ª–∏–∑-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>–ê–Ω–∞–ª–∏–∑</a></span></li><li><span><a href="#–û–±—É—á–µ–Ω–∏–µ" data-toc-modified-id="–û–±—É—á–µ–Ω–∏–µ-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>–û–±—É—á–µ–Ω–∏–µ</a></span></li><li><span><a href="#–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ" data-toc-modified-id="–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a></span></li><li><span><a href="#–ß–µ–∫-–ª–∏—Å—Ç-–ø—Ä–æ–≤–µ—Ä–∫–∏" data-toc-modified-id="–ß–µ–∫-–ª–∏—Å—Ç-–ø—Ä–æ–≤–µ—Ä–∫–∏-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>–ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏</a></span></li></ul></div>

#  –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ —Ç–∞–∫—Å–∏

–ö–æ–º–ø–∞–Ω–∏—è ¬´–ß—ë—Ç–µ–Ω—å–∫–æ–µ —Ç–∞–∫—Å–∏¬ª —Å–æ–±—Ä–∞–ª–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–∞–∑–∞—Ö —Ç–∞–∫—Å–∏ –≤ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞—Ö. –ß—Ç–æ–±—ã –ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å –±–æ–ª—å—à–µ –≤–æ–¥–∏—Ç–µ–ª–µ–π –≤ –ø–µ—Ä–∏–æ–¥ –ø–∏–∫–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, –Ω—É–∂–Ω–æ —Å–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ —Ç–∞–∫—Å–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —á–∞—Å. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –º–æ–¥–µ–ª—å –¥–ª—è —Ç–∞–∫–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.

–ó–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ *RMSE* –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –±–æ–ª—å—à–µ 48.

–í–∞–º –Ω—É–∂–Ω–æ:

1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏—Ö —Ä–µ—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –æ–¥–Ω–æ–º—É —á–∞—Å—É.
2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ.
3. –û–±—É—á–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –°–¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É —Ä–∞–∑–º–µ—Ä–æ–º 10% –æ—Ç –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –∏ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥—ã.


–î–∞–Ω–Ω—ã–µ –ª–µ–∂–∞—Ç –≤ —Ñ–∞–π–ª–µ `taxi.csv`. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å—Ç–æ–ª–±—Ü–µ `num_orders` (–æ—Ç –∞–Ω–≥–ª. *number of orders*, ¬´—á–∏—Å–ª–æ –∑–∞–∫–∞–∑–æ–≤¬ª).

 <div class="alert alert-success">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2> 

<b>–í—Å–µ –æ—Ç–ª–∏—á–Ω–æ!üëç:</b> 
    
–í–∏–∂—É —Ç–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞. –ú–æ–ª–æ–¥–µ—Ü! –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ —Ä–∞—Å—Å—Ç–∞–≤–ª—è—Ç—å –∞–∫—Ü–µ–Ω—Ç—ã –≤ –≤—ã–≤–æ–¥–∞—Ö

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞


```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from statsmodels.tsa.seasonal import seasonal_decompose
from sklearn.linear_model import LinearRegression
from lightgbm import LGBMRegressor
from sklearn.model_selection import train_test_split
from sklearn.model_selection import GridSearchCV
from sklearn.metrics import mean_squared_error, mean_absolute_error
from sklearn.model_selection import cross_val_score
from sklearn.model_selection import TimeSeriesSplit
```


```python
data =  pd.read_csv('/datasets/taxi.csv')
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>num_orders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018-03-01 00:00:00</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018-03-01 00:10:00</td>
      <td>14</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018-03-01 00:20:00</td>
      <td>28</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018-03-01 00:30:00</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2018-03-01 00:40:00</td>
      <td>32</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 26496 entries, 0 to 26495
    Data columns (total 2 columns):
     #   Column      Non-Null Count  Dtype 
    ---  ------      --------------  ----- 
     0   datetime    26496 non-null  object
     1   num_orders  26496 non-null  int64 
    dtypes: int64(1), object(1)
    memory usage: 414.1+ KB



```python
data.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num_orders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>26496.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>14.070463</td>
    </tr>
    <tr>
      <th>std</th>
      <td>9.211330</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>13.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>19.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>119.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
data['datetime']=pd.to_datetime(data['datetime'])
```


```python
data=data.set_index('datetime')
```


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num_orders</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-03-01 00:00:00</th>
      <td>9</td>
    </tr>
    <tr>
      <th>2018-03-01 00:10:00</th>
      <td>14</td>
    </tr>
    <tr>
      <th>2018-03-01 00:20:00</th>
      <td>28</td>
    </tr>
    <tr>
      <th>2018-03-01 00:30:00</th>
      <td>20</td>
    </tr>
    <tr>
      <th>2018-03-01 00:40:00</th>
      <td>32</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-08-31 23:10:00</th>
      <td>32</td>
    </tr>
    <tr>
      <th>2018-08-31 23:20:00</th>
      <td>24</td>
    </tr>
    <tr>
      <th>2018-08-31 23:30:00</th>
      <td>27</td>
    </tr>
    <tr>
      <th>2018-08-31 23:40:00</th>
      <td>39</td>
    </tr>
    <tr>
      <th>2018-08-31 23:50:00</th>
      <td>53</td>
    </tr>
  </tbody>
</table>
<p>26496 rows √ó 1 columns</p>
</div>




```python
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    DatetimeIndex: 26496 entries, 2018-03-01 00:00:00 to 2018-08-31 23:50:00
    Data columns (total 1 columns):
     #   Column      Non-Null Count  Dtype
    ---  ------      --------------  -----
     0   num_orders  26496 non-null  int64
    dtypes: int64(1)
    memory usage: 414.0 KB


–†–µ—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –æ–¥–Ω–æ–º—É —á–∞—Å—É


```python
data = data.resample('1H').sum()
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num_orders</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-03-01 00:00:00</th>
      <td>124</td>
    </tr>
    <tr>
      <th>2018-03-01 01:00:00</th>
      <td>85</td>
    </tr>
    <tr>
      <th>2018-03-01 02:00:00</th>
      <td>71</td>
    </tr>
    <tr>
      <th>2018-03-01 03:00:00</th>
      <td>66</td>
    </tr>
    <tr>
      <th>2018-03-01 04:00:00</th>
      <td>43</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.isna().sum()
```




    num_orders    0
    dtype: int64



 <div class="alert alert-success">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>

<b>–í—Å–µ –æ—Ç–ª–∏—á–Ω–æ!üëç:  </b> 
    
–° –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å, –ø—Ä–æ–≤–µ–¥–µ–Ω –ø–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Å–º–æ—Ç—Ä!) –û—Ç–ª–∏—á–Ω–æ, —á—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ —Ä–µ—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—É–º–º—ã. –ü–æ–ª—É—á–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç –Ω–∞–º –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º —Å –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–æ–π –¥–∞–Ω–Ω—ã—Ö

## –ê–Ω–∞–ª–∏–∑


```python
# –ì—Ä–∞—Ñ–∏–∫ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–æ–≤ –≤ —á–∞—Å
data.plot(figsize=(15,10))
plt.title('–ü–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–æ–≤ –≤ —á–∞—Å')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
```




    Text(0, 0.5, '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')




    
![png](output_20_1.png)
    


–ù–∞–±–ª—é–¥–∞–µ—Ç—Å—è —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è –ø–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤


```python
decomposed = seasonal_decompose(data)
```


```python
#–¢—Ä–µ–Ω–¥
decomposed.trend.plot(figsize=(15,10))
plt.title('–¢—Ä–µ–Ω–¥')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
```




    Text(0, 0.5, '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')




    
![png](output_23_1.png)
    


–¢—Ä–µ–Ω–¥ —Ä–∞—Å—Ç–µ—Ç


```python
#–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å
decomposed.seasonal.plot(figsize=(15,10))
plt.title('–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
```




    Text(0, 0.5, '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')




    
![png](output_25_1.png)
    


–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏


```python
#–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –≤ –º–µ–Ω—å—à–µ–º –º–∞—Å—à—Ç–∞–±–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä —Ç—Ä–∏ –¥–Ω—è –∞–≤–≥—É—Å—Ç–∞
decomposed.seasonal['2018-08-01':'2018-08-03'].plot(figsize=(15,10))
plt.title('–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
```




    Text(0, 0.5, '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')




    
![png](output_27_1.png)
    



```python
#–û—Å—Ç–∞—Ç–æ–∫
decomposed.resid.plot(figsize=(15,10))
plt.title('–û—Å—Ç–∞—Ç–æ–∫ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
```




    Text(0, 0.5, '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')




    
![png](output_28_1.png)
    



```python

```


```python
data['rolling_mean'] = data.rolling(10).mean()
data.plot(figsize=(15,10))
plt.title('–°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤')
plt.show()
```


    
![png](output_30_0.png)
    



```python
print('–°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ = ',decomposed.trend.mean())
```

    –°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ =  84.26974233454767


<div class="alert alert-warning">
    <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>
    
<b>–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏üí°:</b>  
    
–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è —Å–¥–µ–ª–∞–Ω–∞ –≤–µ—Ä–Ω–æ. –ú–æ–∂–Ω–æ –µ—â–µ  –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –Ω–∞ –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ

<br/>
<div class="alert alert-block alert-danger">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"></h2>
    
<b>–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—Éü§î:</b>
    
–¢—É—Ç —Å–ª–µ–¥—É–µ—Ç –µ—â–µ –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–≤–æ–¥, –∏ –æ–ø–∏—Å–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Ç—Ä–µ–Ω–¥–µ –∏ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏. 
–î–æ–±–∞–≤—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞
 </div>

 <br/>    
<div class="alert alert-info">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞: <a class="tocSkip"> </h2>

–î–æ–±–∞–≤–∏–ª –≤—ã–≤–æ–¥ –ø–æ –≥—Ä–∞—Ñ–∏–∫–∞–º
</div> 

<br/> 

<div class="alert alert-success">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2 <a class="tocSkip"> </h2>

<b>–í—Å–µ –æ—Ç–ª–∏—á–Ω–æ!üëç:</b> 

–í—ã–≤–æ–¥: –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ —Ç—Ä–µ–Ω–¥–∞ –≤–∏–¥–∏–º –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —á–∏—Å–ª–∞ –∑–∞–∫–∞–∑–æ–≤ –≤–µ—Å–Ω–æ–π, –ª–µ—Ç–æ–º —É—Å–ª—É–≥–∏ —Ç–∞–∫—Å–∏ –Ω–∞–º–Ω–æ–≥–æ –±–æ–ª–µ–µ –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã. –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã—Ö: —É –Ω–∞—Å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤ –ø–æ–ª–≥–æ–¥–∞. –ù–æ –µ—Å–ª–∏ —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ —Ç—Ä–µ—Ö –¥–Ω–µ–π, –º–æ–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è, —Å —É—Ç—Ä–∞ –∏ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å—É—Ç–æ–∫, –∫–æ–≥–¥–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

## –û–±—É—á–µ–Ω–∏–µ

–ù–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤


```python
def make_features(data, max_lag, rolling_mean_size):
    
    data['dayofweek'] = data.index.dayofweek
    data['hour'] = data.index.hour
    data['day'] = data.index.day
    
    
    for lag in range(1, max_lag + 1):
        data['lag_{}'.format(lag)] = data['num_orders'].shift(lag)

    data['rolling_mean'] = data['num_orders'].shift().rolling(rolling_mean_size).mean()
    
    return data
```

<div class="alert alert-warning">
    <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>
    
<b>–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏üí°:</b>
        
–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, —á—Ç–æ–±—ã –æ–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ –Ω–æ–≤—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º, –∞ –Ω–µ –∏–∑–º–µ–Ω—è–ª–∞ –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é.
        
1. –≠—Ç–æ —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ (–Ω–µ –∏–∑–º–µ–Ω—è—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏), –∫–æ—Ç–æ—Ä–∞—è —É–ª—É—á—à–∞–µ—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞.
2. –í –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –º–æ–∂–µ—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –ø–æ–¥–±–∏—Ä–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏. –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ —Å—Ç–∞–Ω–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º.

        
        
        
–î–ª—è —ç—Ç–æ–≥–æ –≤–Ω—É—Ç—Ä–∏, –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω—É–∂–Ω–æ –∑–∞–¥–∞—Ç—å –Ω–æ–≤–æ–µ –∏–º—è –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—É —Å `df.copy()`, –≤ –Ω–µ–º —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏, –∞ –≤ –∫–æ–Ω—Ü–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —á–µ—Ä–µ–∑ `return` —ç—Ç–æ—Ç –¥–∞—Ç–∞—Ñ—Ä–µ–π–º
</div>


```python
make_features(data, 24, 10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>num_orders</th>
      <th>rolling_mean</th>
      <th>dayofweek</th>
      <th>hour</th>
      <th>day</th>
      <th>lag_1</th>
      <th>lag_2</th>
      <th>lag_3</th>
      <th>lag_4</th>
      <th>lag_5</th>
      <th>...</th>
      <th>lag_15</th>
      <th>lag_16</th>
      <th>lag_17</th>
      <th>lag_18</th>
      <th>lag_19</th>
      <th>lag_20</th>
      <th>lag_21</th>
      <th>lag_22</th>
      <th>lag_23</th>
      <th>lag_24</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-03-01 00:00:00</th>
      <td>124</td>
      <td>NaN</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2018-03-01 01:00:00</th>
      <td>85</td>
      <td>NaN</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>124.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2018-03-01 02:00:00</th>
      <td>71</td>
      <td>NaN</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>85.0</td>
      <td>124.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2018-03-01 03:00:00</th>
      <td>66</td>
      <td>NaN</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>71.0</td>
      <td>85.0</td>
      <td>124.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2018-03-01 04:00:00</th>
      <td>43</td>
      <td>NaN</td>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>66.0</td>
      <td>71.0</td>
      <td>85.0</td>
      <td>124.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2018-08-31 19:00:00</th>
      <td>136</td>
      <td>173.3</td>
      <td>4</td>
      <td>19</td>
      <td>31</td>
      <td>207.0</td>
      <td>217.0</td>
      <td>197.0</td>
      <td>116.0</td>
      <td>133.0</td>
      <td>...</td>
      <td>268.0</td>
      <td>99.0</td>
      <td>230.0</td>
      <td>194.0</td>
      <td>276.0</td>
      <td>246.0</td>
      <td>158.0</td>
      <td>198.0</td>
      <td>142.0</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>2018-08-31 20:00:00</th>
      <td>154</td>
      <td>166.6</td>
      <td>4</td>
      <td>20</td>
      <td>31</td>
      <td>136.0</td>
      <td>207.0</td>
      <td>217.0</td>
      <td>197.0</td>
      <td>116.0</td>
      <td>...</td>
      <td>78.0</td>
      <td>268.0</td>
      <td>99.0</td>
      <td>230.0</td>
      <td>194.0</td>
      <td>276.0</td>
      <td>246.0</td>
      <td>158.0</td>
      <td>198.0</td>
      <td>142.0</td>
    </tr>
    <tr>
      <th>2018-08-31 21:00:00</th>
      <td>159</td>
      <td>162.9</td>
      <td>4</td>
      <td>21</td>
      <td>31</td>
      <td>154.0</td>
      <td>136.0</td>
      <td>207.0</td>
      <td>217.0</td>
      <td>197.0</td>
      <td>...</td>
      <td>35.0</td>
      <td>78.0</td>
      <td>268.0</td>
      <td>99.0</td>
      <td>230.0</td>
      <td>194.0</td>
      <td>276.0</td>
      <td>246.0</td>
      <td>158.0</td>
      <td>198.0</td>
    </tr>
    <tr>
      <th>2018-08-31 22:00:00</th>
      <td>223</td>
      <td>162.1</td>
      <td>4</td>
      <td>22</td>
      <td>31</td>
      <td>159.0</td>
      <td>154.0</td>
      <td>136.0</td>
      <td>207.0</td>
      <td>217.0</td>
      <td>...</td>
      <td>46.0</td>
      <td>35.0</td>
      <td>78.0</td>
      <td>268.0</td>
      <td>99.0</td>
      <td>230.0</td>
      <td>194.0</td>
      <td>276.0</td>
      <td>246.0</td>
      <td>158.0</td>
    </tr>
    <tr>
      <th>2018-08-31 23:00:00</th>
      <td>205</td>
      <td>170.8</td>
      <td>4</td>
      <td>23</td>
      <td>31</td>
      <td>223.0</td>
      <td>159.0</td>
      <td>154.0</td>
      <td>136.0</td>
      <td>207.0</td>
      <td>...</td>
      <td>182.0</td>
      <td>46.0</td>
      <td>35.0</td>
      <td>78.0</td>
      <td>268.0</td>
      <td>99.0</td>
      <td>230.0</td>
      <td>194.0</td>
      <td>276.0</td>
      <td>246.0</td>
    </tr>
  </tbody>
</table>
<p>4416 rows √ó 29 columns</p>
</div>



<div class="alert alert-warning">
    <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>
    
<b>–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏üí°:</b>


–ú–µ—Ç—Ä–∏–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∏–∂–µ 48, –ø–æ—ç—Ç–æ–º—É —Å—Ç–æ–∏—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∑–∞–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä max_lag —Ä–∞–≤–Ω—ã–º 24 –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ñ—É–Ω–∫—Ü–∏–µ–π. –í —Å–ª—É—á–∞–µ –∑–∞–∫–∞–∑–æ–≤ —Ç–∞–∫—Å–∏ —Å–∞–º–∞—è –æ—á–µ–≤–∏–¥–Ω–∞—è —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å - –≤–Ω—É—Ç—Ä–∏ —Å—É—Ç–æ–∫, –∞ –≤ —Å—É—Ç–∫–∞—Ö 24 —á–∞—Å–∞, —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –±—É–¥–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º

<br/>    
<div class="alert alert-info">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞: <a class="tocSkip"> </h2>

—Å–¥–µ–ª–∞–ª max_lag = 24
</div> 

<br/> 

<div class="alert alert-success">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2 <a class="tocSkip"> </h2>

<b>–í—Å–µ –æ—Ç–ª–∏—á–Ω–æ!üëç:</b> 

–†–∞–∑–¥–µ–ª–∏–º –Ω–∞ –≤—ã–±–æ—Ä–∫–∏, —Ç–µ—Å—Ç–æ–≤—É—é —Å–¥–µ–ª–∞–µ–º —Ä–∞–∑–º–µ—Ä–æ–º 10% –æ—Ç –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö


```python
train,test = train_test_split(data, shuffle=False, test_size=0.1)
```

 <div class="alert alert-success">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>

<b>–í—Å–µ –æ—Ç–ª–∏—á–Ω–æ!üëç:  </b>
    
–•–æ—Ä–æ—à–æ, —á—Ç–æ –¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏


```python
train = train.dropna()
```


```python
features_train = train.drop(['num_orders'],axis=1)
target_train = train['num_orders']
```


```python
features_test = test.drop(['num_orders'],axis=1)
target_test = test['num_orders']
```


```python

```

–ü—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä


```python
features_train.shape
```




    (3950, 28)




```python
target_train.shape
```




    (3950,)




```python
features_test.shape
```




    (442, 28)




```python
target_test.shape
```




    (442,)



LinearRegression


```python
%%time
tscv = TimeSeriesSplit(n_splits=5)

regressor = LinearRegression()
print('# Train for root_mean_squared_error')
cv_RMSE_LR = (cross_val_score(regressor, 
                             features_train, 
                             target_train, 
                             cv=tscv, 
                             scoring='neg_mean_squared_error').mean() * -1) ** 0.5
print('Mean RMSE from CV of LinearRegression =', cv_RMSE_LR)
```

    # Train for root_mean_squared_error
    Mean RMSE from CV of LinearRegression = 27.372958358457
    CPU times: user 224 ms, sys: 734 ms, total: 958 ms
    Wall time: 898 ms


LGBMR


```python
%%time
model = LGBMRegressor()
parameters = [{'num_leaves':[25,50], 'learning_rate':[0.1,0.3], 'random_state':[12345]}]

tscv = TimeSeriesSplit(n_splits=5)

clf = GridSearchCV(model, parameters, scoring='neg_mean_squared_error', cv=tscv)
clf.fit(features_train, target_train)

print(clf.best_params_)
print()

mts = clf.cv_results_['mean_test_score']

rmse = (max(mts) * -1) ** 0.5
print('RMSE –º–æ–¥–µ–ª–∏ LGBMR =',rmse)
```


```python

```

<br/>
<div class="alert alert-block alert-danger">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"></h2>
    
<b>–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—Éü§î:</b>
    
–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏ –Ω–µ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é, —Ç–∞–∫ –∫–∞–∫ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –æ–∫–∞–∂–µ—Ç—Å—è –ø–æ–∑–∂–µ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π. –î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html">TimeSeriesSplit</a>. –û–±—ä–µ–∫—Ç —ç—Ç–æ–≥–æ —Ç–∏–ø–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä cv –≤ –º–µ—Ç–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏
    
(—ç—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π, –≤—Å–µ—Ö cross_val_score –∏ –≤—Å–µ—Ö SearchCV)
</div>

<br/>    
<div class="alert alert-info">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞: <a class="tocSkip"> </h2>

–î–æ–±–∞–≤–∏–ª TimeSeriesSplit
</div> 

<br/> 

<div class="alert alert-success">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2 <a class="tocSkip"> </h2>

<b>–í—Å–µ –æ—Ç–ª–∏—á–Ω–æ!üëç:</b> 

 <div class="alert alert-success">
<h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>

<b>–í—Å–µ –æ—Ç–ª–∏—á–Ω–æ!üëç:  </b>
    
–ú–æ–ª–æ–¥–µ—Ü, —á—Ç–æ –ø—Ä–æ–±—É–µ—à—å —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –≤ —ç—Ç–æ–º —à–∞–≥–µ)
</div>

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –ø—Ä–æ–≤–µ—Ä–∏–º –º–æ–¥–µ–ª—å LGBMR, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –ø–æ–∫–∞–∑–∞–ª–∞ –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç


```python
model = LGBMRegressor(learning_rate=0.1, num_leaves=25, random_state=12345)
model.fit(features_train, target_train)
predictions = model.predict(features_test)
rmse = mean_squared_error(target_test, predictions) ** 0.5
print('RMSE –º–æ–¥–µ–ª–∏ LGBMR –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ =', rmse)
```

<div class="alert alert-warning">
    <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>
    
<b>–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏üí°:</b>
    
–ù–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –ø–æ–ª—É—á–µ–Ω–æ —Ö–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–æ–Ω–∞ —É –Ω–∞—Å –∏–≥—Ä–∞–µ—Ç —Ä–æ–ª—å –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π, holdout), –Ω–æ –∑–Ω–∞–π, —á—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –¥–ª—è –æ–¥–Ω–æ–π –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏. –ù–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ –º—ã –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª–∏ –∏ –≤—ã–±—Ä–∞—Ç—å –æ–¥–Ω—É –Ω–∞–∏–ª—É—á—à—É—é, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –º–µ—Ç—Ä–∏–∫–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—á–∏–∫–æ–º (—ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ, –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è, —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏ —Ç.–¥.). –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –º—ã –º–æ–¥–µ–ª–∏—Ä—É–µ–º —Ä–∞–±–æ—Ç—É –º–æ–¥–µ–ª–∏ –Ω–∞ –Ω–æ–≤—ã—Ö –Ω–µ–∑–Ω–∞–∫–æ–º—ã—Ö –µ–π –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏ —Ä–∞–∑—É –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –Ω–∏ –ø—Ä–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ, –Ω–∏ –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å–ª–æ–≤–∏–ª–∏ –ª–∏ –º—ã –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ. –ê —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–º–µ—â–µ–Ω–Ω—ã–º–∏, —Å –≤—ã–±—Ä–æ—Å–∞–º–∏ –∏ —Ç.–¥. –¢–æ –µ—Å—Ç—å –ø–æ —Ç–∞–∫–∏–º –¥–∞–Ω–Ω—ã–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–Ω–æ–≤–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –º–æ–¥–µ–ª—å-–ø–æ–±–µ–¥–∏—Ç–µ–ª—å.  –°–æ–≤–µ—Ç—É—é —Ç–µ–±–µ —Å—Ç–∞—Ç—å—é, —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—â—É—é —Ä–∞–∑–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è: https://towardsdatascience.com/validating-your-machine-learning-model-25b4c8643fb7 (–Ω—É–∂–µ–Ω VPN)
        
–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å —Ü–µ–ª—å—é –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏—Ö —Å–º–µ—â–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –Ω–∞ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏/ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ. –ù–æ —ç—Ç–æ –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å-–ø–æ–±–µ–¥–∏—Ç–µ–ª—å –¥–æ–ª–∂–Ω–∞ –≤—ã–±–∏—Ä–∞—Ç—å—Å—è –∏—Å—Ö–æ–¥—è –∏–∑ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ.   

<div class="alert alert-warning">
    <h2> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>
    
<b>–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏üí°:</b>
    
–í –∫–æ–Ω—Ü–µ –ø—Ä–æ–µ–∫—Ç–∞ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–ø–æ—Å—Ç—Ä–æ–∏—Ç—å 2 –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–∞ –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ), –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏ —Ä–µ–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ
        


–í—ã–≤–æ–¥: –ø–µ—Ä–µ–¥ –Ω–∞–º–∏ —Å—Ç–æ—è–ª–∞ –∑–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏, –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É—é—â–µ–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ —Ç–∞–∫—Å–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —á–∞—Å. –õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∞ –º–æ–¥–µ–ª—å LGBMRegressor. –ù–∞–º —É–¥–∞–ª–æ—Å—å –¥–æ–±–∏—Ç—å—Å—è –Ω—É–∂–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫–∏: RMSE = 41. –≠—Ç–æ –º–µ–Ω—å—à–µ 48. –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ.

<div style="border:solid Chocolate 2px; padding: 40px">


<h2> –ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ <a class="tocSkip"> </h2>    
    
  
–£ –º–µ–Ω—è —Å–ª–æ–∂–∏–ª–æ—Å—å —Ö–æ—Ä–æ—à–µ–µ –æ–±—â–µ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ –æ –ø—Ä–æ–µ–∫—Ç–µ, —Ç–µ–±–µ —É–¥–∞–ª–æ—Å—å –Ω–µ–ø–ª–æ—Ö–æ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å —ç—Ç–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º. –ú–æ–ª–æ–¥–µ—Ü! –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞, –∏–∑—É—á–µ–Ω –∫–∞–∂–¥—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä. –í—Å–µ –∫—Ä–∞—Å–∏–≤–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ, –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏ –æ—Ü–µ–Ω–µ–Ω–æ –∏—Ö –∫–∞—á–µ—Å—Ç–≤–æ. –û—Å–º—ã—Å–ª–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –¥–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ - –º–Ω–æ–≥–æ–µ —É–¥–∞–ª–æ—Å—å –∫–∞–∫ –Ω–∞–¥–æ)
    
–û—Ç–º–µ—á—É –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞üôÇ:
    
- –≤ —Ö–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å  —Ñ—É–Ω–∫—Ü–∏–∏, –ø–æ–º–æ–≥–∞—é—â–∏–µ –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞;
- –º–Ω–æ–≥–æ –∫—Ä–∞—Å–∏–≤—ã—Ö –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏ —Ö–æ—Ä–æ—à–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è;
- –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.
    
–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–æ–≤ –≤—Å–µ–≥–æ, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏—Ç –µ—â—ë —Ä–∞–∑ –≤–∑–≥–ª—è–Ω—É—Ç—å, —è —É–∫–∞–∑–∞–ª –∏—Ö –≤ –º–æ–∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –ø–æ —Ö–æ–¥—É –ø—Ä–æ–µ–∫—Ç–∞. –ü—Ä–µ–¥–ª–∞–≥–∞—é —Ç–µ–±–µ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –ø–æ –º–æ–∏–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º, —á—Ç–æ–±—ã –¥–æ–≤–µ—Å—Ç–∏ –µ–≥–æ –¥–æ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞.

    
 
</div>

<div style="border:solid Chocolate 2px; padding: 40px">


<h2> –ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ 2 <a class="tocSkip"> </h2>    
    
     
  
–¢–µ–ø–µ—Ä—å –ø–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ. –ü—Ä–∏–Ω–∏–º–∞—é —Ä–∞–±–æ—Ç—É)
    
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ª—É—á—à–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —Ç–µ–º–µ, —Ç–æ –º–æ–≥—É –ø–æ—Å–æ–≤–µ—Ç–æ–≤–∞—Ç—å —Ç–µ–±–µ: 
    
–ü–æ–ª–µ–∑–Ω–∞—è –ª–µ–∫—Ü–∏—è –ø—Ä–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã: https://www.youtube.com/watch?v=u433nrxdf5k    
    
–ë.–ë. –î–µ–º–µ—à–µ–≤ - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã https://disk.yandex.ru/i/LiDHB-B3A6Lz5A
    
–ë–∞–∑–æ–≤–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ ARIMA - https://colab.research.google.com/drive/17RnG91Eq8JBKyxToNzvCvjibfxum-oPj?usp=sharing
    
–ö–∞–Ω—Ç–æ—Ä–æ–≤–∏—á - –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ https://yadi.sk/i/IOkUOS3hTXf3gg
https://facebook.github.io/prophet/
    
https://facebook.github.io/prophet/docs/quick_start.html#python-api
    
https://nbviewer.jupyter.org/github/miptgirl/habra_materials/blob/master/prophet/habra_data.ipynb  
    
    
    
–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –±—ã–ª–∏ –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω—ã –≤—Å–µ –º–æ–º–µ–Ω—Ç—ã. 
    
–£—Å–ø–µ—Ö–æ–≤ —Ç–µ–±–µ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Å–ø—Ä–∏–Ω—Ç–µ!
    
–†–∞–¥ –±—ã–ª –ø–æ–º–æ—á—å —Ç–µ–±–µ)
    
</div>

## –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

- [x]  Jupyter Notebook –æ—Ç–∫—Ä—ã—Ç
- [ ]  –í–µ—Å—å –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ]  –Ø—á–µ–π–∫–∏ —Å –∫–æ–¥–æ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –ø–æ—Ä—è–¥–∫–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- [ ]  –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã
- [ ]  –î–∞–Ω–Ω—ã–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- [ ]  –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞, –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–æ–±—Ä–∞–Ω—ã
- [ ]  –ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ, –≤—ã–≤–æ–¥—ã —Å–¥–µ–ª–∞–Ω—ã
- [ ]  –ó–Ω–∞—á–µ–Ω–∏–µ *RMSE* –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –Ω–µ –±–æ–ª—å—à–µ 48

<h1>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞" data-toc-modified-id="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞</a></span></li><li><span><a href="#–ê–Ω–∞–ª–∏–∑" data-toc-modified-id="–ê–Ω–∞–ª–∏–∑-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>–ê–Ω–∞–ª–∏–∑</a></span></li><li><span><a href="#–û–±—É—á–µ–Ω–∏–µ" data-toc-modified-id="–û–±—É—á–µ–Ω–∏–µ-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>–û–±—É—á–µ–Ω–∏–µ</a></span></li><li><span><a href="#–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ" data-toc-modified-id="–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a></span></li><li><span><a href="#–ß–µ–∫-–ª–∏—Å—Ç-–ø—Ä–æ–≤–µ—Ä–∫–∏" data-toc-modified-id="–ß–µ–∫-–ª–∏—Å—Ç-–ø—Ä–æ–≤–µ—Ä–∫–∏-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>–ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏</a></span></li></ul></div>
